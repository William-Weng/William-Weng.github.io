
<!DOCTYPE html>
<html
  lang="en"
  data-figures=""
  
    class="page"
  
  
  >
  <head>
<title>【Rust】Bruno我來了，一起來打網路API… | William-Weng</title>
<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">





<meta property="og:locale" content="en" />

<meta property="og:type" content="article">
<meta name="description" content="前言
根據尼爾森的不正確調查，上一期文章的收視率高達了87%，因應廣大網友的要求，筆者只好再緊急加映一集…這集就進階一點，來做做網路API吧，把CSV文件當成簡單的資料來源，讀取文件後，轉成JSON格式輸出，達到隔空抓藥的效果…" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:creator" content="">
<meta name="twitter:title" content="【Rust】Bruno我來了，一起來打網路API…" />
<meta name="twitter:image" content="https://William-Weng.github.io/images/thumbnail/Rust.png"/>
<meta property="og:url" content="https://William-Weng.github.io/2025/06/rustbruno%E6%88%91%E4%BE%86%E4%BA%86%E4%B8%80%E8%B5%B7%E4%BE%86%E6%89%93%E7%B6%B2%E8%B7%AFapi/" />
<meta property="og:title" content="【Rust】Bruno我來了，一起來打網路API…" />
<meta property="og:description" content="前言
根據尼爾森的不正確調查，上一期文章的收視率高達了87%，因應廣大網友的要求，筆者只好再緊急加映一集…這集就進階一點，來做做網路API吧，把CSV文件當成簡單的資料來源，讀取文件後，轉成JSON格式輸出，達到隔空抓藥的效果…" />
<meta property="og:image" content="https://William-Weng.github.io/images/thumbnail/Rust.png" />
  <meta name="keywords" content="rust,cargo,csv,api" />

<link rel="apple-touch-icon" sizes="180x180" href="https://William-Weng.github.io/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://William-Weng.github.io/icons/favicon-32x32.png">
<link rel="manifest" href="https://William-Weng.github.io/icons/site.webmanifest">

<link rel="canonical" href="https://William-Weng.github.io/2025/06/rustbruno%E6%88%91%E4%BE%86%E4%BA%86%E4%B8%80%E8%B5%B7%E4%BE%86%E6%89%93%E7%B6%B2%E8%B7%AFapi/">



<link rel="preload" href="https://William-Weng.github.io/css/styles.a556cef0edd8ecd9821e661f7f201d84cc18d0c6435703889db2949aea0eccb84b7ac9a2bb49093b03f5e7d9ce21c23c705efd6dcbd7e8018afae9a9f32ca095.css" integrity = "sha512-pVbO8O3Y7NmCHmYffyAdhMwY0MZDVwOInbKUmuoOzLhLesmiu0kJOwP159nOIcI8cF79bcvX6AGK&#43;ump8yyglQ==" as="style" crossorigin="anonymous">



<link rel="preload" href="https://William-Weng.github.io/en/js/bundle.ef18b7cbccbaaff8de21870709eafc196f6f5ffe0a978d7cc1fc489d084755617a79d19dff9f284e00b02ee517b64e64dc02d7ea310d40d485a957333cef7099.js" as="script" integrity=
"sha512-7xi3y8y6r/jeIYcHCer8GW9vX/4Kl418wfxInQhHVWF6edGd/58oTgCwLuUXtk5k3ALX6jENQNSFqVczPO9wmQ==" crossorigin="anonymous">


<link rel="stylesheet" type="text/css" href="https://William-Weng.github.io/css/styles.a556cef0edd8ecd9821e661f7f201d84cc18d0c6435703889db2949aea0eccb84b7ac9a2bb49093b03f5e7d9ce21c23c705efd6dcbd7e8018afae9a9f32ca095.css" integrity="sha512-pVbO8O3Y7NmCHmYffyAdhMwY0MZDVwOInbKUmuoOzLhLesmiu0kJOwP159nOIcI8cF79bcvX6AGK&#43;ump8yyglQ==" crossorigin="anonymous">

  </head>
  <body
    data-code="100"
    data-lines="true"
    id="documentTop"
    data-lang="en"
  >

<header class="nav_header" >
  <nav class="nav"><a href='https://William-Weng.github.io/' class="nav_brand nav_item" title="William-Weng">William-Weng
  <div class="nav_close">
    <div><svg class="icon">
  <title>open-menu</title>
  <use xlink:href="#open-menu"></use>
</svg>
<svg class="icon">
  <title>closeme</title>
  <use xlink:href="#closeme"></use>
</svg>
</div>
  </div>
</a>

    <div class='nav_body nav_body_left'>
      
      
      
        

      
<div class='follow'>
<div class="color_mode">
  <input type="checkbox" class="color_choice" id="mode">
</div>

</div>

    </div>
  </nav>
</header>

    <main>
  
<div class="grid-inverse wrap content">
  <article class="post_content">
    <h1 class="post_title">【Rust】Bruno我來了，一起來打網路API…</h1>
  <div class="post_meta">
    <span><svg class="icon">
  <title>calendar</title>
  <use xlink:href="#calendar"></use>
</svg>
</span>
    <span class="post_date">
      Jun 12, 2025</span>
    <span class="post_time"> · 13 min read</span><span>&nbsp;· <a href='https://William-Weng.github.io/tags/rust/' title="rust" class="post_tag button button_translucent">rust
        </a><a href='https://William-Weng.github.io/tags/cargo/' title="cargo" class="post_tag button button_translucent">cargo
        </a><a href='https://William-Weng.github.io/tags/csv/' title="csv" class="post_tag button button_translucent">csv
        </a><a href='https://William-Weng.github.io/tags/api/' title="api" class="post_tag button button_translucent">api
        </a>
    </span>
    <span class="page_only">&nbsp;·
  <div class="post_share">
    Share on:
    <a href="https://twitter.com/intent/tweet?text=%e3%80%90Rust%e3%80%91Bruno%e6%88%91%e4%be%86%e4%ba%86%ef%bc%8c%e4%b8%80%e8%b5%b7%e4%be%86%e6%89%93%e7%b6%b2%e8%b7%afAPI%e2%80%a6&url=https%3a%2f%2fWilliam-Weng.github.io%2f2025%2f06%2frustbruno%25E6%2588%2591%25E4%25BE%2586%25E4%25BA%2586%25E4%25B8%2580%25E8%25B5%25B7%25E4%25BE%2586%25E6%2589%2593%25E7%25B6%25B2%25E8%25B7%25AFapi%2f&tw_p=tweetbutton" class="twitter" title="Share on Twitter" target="_blank" rel="nofollow">
      <svg class="icon">
  <title>twitter</title>
  <use xlink:href="#twitter"></use>
</svg>

    </a>
    <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fWilliam-Weng.github.io%2f2025%2f06%2frustbruno%25E6%2588%2591%25E4%25BE%2586%25E4%25BA%2586%25E4%25B8%2580%25E8%25B5%25B7%25E4%25BE%2586%25E6%2589%2593%25E7%25B6%25B2%25E8%25B7%25AFapi%2f&t=%e3%80%90Rust%e3%80%91Bruno%e6%88%91%e4%be%86%e4%ba%86%ef%bc%8c%e4%b8%80%e8%b5%b7%e4%be%86%e6%89%93%e7%b6%b2%e8%b7%afAPI%e2%80%a6" class="facebook" title="Share on Facebook" target="_blank" rel="nofollow">
      <svg class="icon">
  <title>facebook</title>
  <use xlink:href="#facebook"></use>
</svg>

    </a>
    <a href="#linkedinshare" id = "linkedinshare" class="linkedin" title="Share on LinkedIn" rel="nofollow">
      <svg class="icon">
  <title>linkedin</title>
  <use xlink:href="#linkedin"></use>
</svg>

    </a>
    <a href="https://William-Weng.github.io/2025/06/rustbruno%E6%88%91%E4%BE%86%E4%BA%86%E4%B8%80%E8%B5%B7%E4%BE%86%E6%89%93%E7%B6%B2%E8%B7%AFapi/" title="Copy Link" class="link link_yank">
      <svg class="icon">
  <title>copy</title>
  <use xlink:href="#copy"></use>
</svg>

    </a>
  </div>
  </span>
  </div>

    <div class="post_body"><h2 id="前言">前言</h2>
<p>根據<a href="https://www.104.com.tw/company/a93tesw">尼爾森</a>的不正確調查，<a href="/2025/05/rust%E8%9E%83%E8%9F%B9%E4%B8%80%E5%91%80%E7%88%AA%E5%85%AB%E5%80%8B%E5%85%A9%E9%A0%AD%E5%B0%96%E5%B0%96%E9%80%99%E9%BA%BC%E5%A4%A7%E7%9A%84%E5%80%8B/">上一期</a>文章的<a href="https://youtu.be/SAx3XWXIC-s">收視率</a>高達了<a href="https://pttpedia.fandom.com/zh/wiki/87%E5%88%86%EF%BC%8C%E4%B8%8D%E8%83%BD%E5%86%8D%E9%AB%98%E4%BA%86">87%</a>，因應廣大網友的要求，筆者只好再<a href="https://www.usebruno.com/">緊急加映</a>一集…這集就進階一點，來做做網路API吧，把CSV文件當成簡單的資料來源，讀取文件後，轉成JSON格式輸出，達到<a href="https://youtu.be/QPVZlat7EtU">隔空抓藥</a>的效果…</p>
<h2 id="作業環境">作業環境</h2>
<table>
  <thead>
      <tr>
          <th>項目</th>
          <th>版本</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="https://www.apple.com/tw/macos/macos-sequoia/">macOS</a></td>
          <td>Sequoia 15.5</td>
      </tr>
      <tr>
          <td><a href="https://code.visualstudio.com/">Visual Studio Code</a></td>
          <td>1.100.3</td>
      </tr>
      <tr>
          <td><a href="https://www.rust-lang.org/">Rust</a></td>
          <td>1.87.0</td>
      </tr>
      <tr>
          <td><a href="https://www.usebruno.com/">Bruno</a></td>
          <td>2.4.0</td>
      </tr>
  </tbody>
</table>
<h2 id="rust套件">Rust套件</h2>
<table>
  <thead>
      <tr>
          <th>套件</th>
          <th>版本</th>
          <th>功能</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="https://actix.rs/">actix-web</a></td>
          <td>4.4.0</td>
          <td>是一個高效能、非常靈活的 Rust 網頁框架。可以建立網頁伺服器、客戶端</td>
      </tr>
      <tr>
          <td><a href="https://github.com/actix/actix-web">actix-multipart</a></td>
          <td>0.6</td>
          <td>actix-web的多檔案下載功能套件</td>
      </tr>
      <tr>
          <td><a href="https://github.com/serde-rs/serde">serde</a></td>
          <td>1.0</td>
          <td>是Rust生態系統中最受歡迎的序列化框架之一，提供了高效能且易於使用的JSON處理功能</td>
      </tr>
      <tr>
          <td><a href="https://docs.rs/serde_json/latest/serde_json/">serde_json</a></td>
          <td>1.0</td>
          <td>是用於處理JSON資料的Serde的一部分</td>
      </tr>
      <tr>
          <td><a href="https://github.com/colored-rs/colored">colored</a></td>
          <td>3.0</td>
          <td>為終端機輸出添加顏色</td>
      </tr>
      <tr>
          <td><a href="https://github.com/LeoBorai/local-ip-address">local-ip-address</a></td>
          <td>0.6.5</td>
          <td>取得本地端的區網IP位置</td>
      </tr>
      <tr>
          <td><a href="https://github.com/BurntSushi/rust-csv">csv</a></td>
          <td>1.3.1</td>
          <td>快速處理可變動的CSV文件</td>
      </tr>
      <tr>
          <td><a href="https://rust-lang.github.io/futures-rs/">futures</a></td>
          <td>0.3.31</td>
          <td>非同步功能實現 - Future、Stream、Sink</td>
      </tr>
      <tr>
          <td><a href="https://github.com/chronotope/chrono">chrono</a></td>
          <td>0.4</td>
          <td>處理日期 / 時間 / 時區的套件</td>
      </tr>
      <tr>
          <td><a href="https://github.com/actix/actix-files">actix-files</a></td>
          <td>0.6.6</td>
          <td>提供靜態文件服務</td>
      </tr>
      <tr>
          <td><a href="https://github.com/uuid-rs/uuid">uuid</a></td>
          <td>0.8.2</td>
          <td>生成和操作UUID的套件</td>
      </tr>
  </tbody>
</table>
<h2 id="安裝rust套件">安裝Rust套件</h2>
<ul>
<li>這裡先用指令建立一個名叫rust_csv_api的專案名稱，注意要用小寫喲…
<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/new.png"
      
      
    />

    </picture>
</figure>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cargo new rust_csv_api
</span></span></code></pre></div><ul>
<li>然後更新Cargo.toml的內容，填入後面要用到的套件們…
<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/package.png"
      
      
    />

    </picture>
</figure>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span>[<span style="color:#a6e22e">dependencies</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">actix-web</span> = <span style="color:#e6db74">&#34;4.4.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">actix-multipart</span> = <span style="color:#e6db74">&#34;0.6&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">serde</span> = { <span style="color:#a6e22e">version</span> = <span style="color:#e6db74">&#34;1.0&#34;</span>, <span style="color:#a6e22e">features</span> = [<span style="color:#e6db74">&#34;derive&#34;</span>] }
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">serde_json</span> = { <span style="color:#a6e22e">version</span> = <span style="color:#e6db74">&#34;1.0&#34;</span> }
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">csv</span> = <span style="color:#e6db74">&#34;1.3.1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">futures</span> = <span style="color:#e6db74">&#34;0.3.31&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">chrono</span> = { <span style="color:#a6e22e">version</span> = <span style="color:#e6db74">&#34;0.4&#34;</span>, <span style="color:#a6e22e">features</span> = [<span style="color:#e6db74">&#34;serde&#34;</span>] }
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">colored</span> = <span style="color:#e6db74">&#34;3.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">local-ip-address</span> = <span style="color:#e6db74">&#34;0.6.5&#34;</span>
</span></span></code></pre></div><ul>
<li>之後在終端機執行以下的指令就會下載安裝了，你會看到會多出一個名叫target的資料夾，容量很大…</li>
<li>當然，要用到的兩筆CSV文件也就順便放在document的目錄之中了…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cargo check
</span></span></code></pre></div><ul>
<li>當然，要清掉的話也是可以的…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cargo clean                     <span style="color:#75715e"># 清理當前編譯產物</span>
</span></span><span style="display:flex;"><span>cargo clean --target debug		<span style="color:#75715e"># 清理當前編譯產物 for debug環境</span>
</span></span><span style="display:flex;"><span>cargo clean --target release	<span style="color:#75715e"># 清理當前編譯產物 for release環境</span>
</span></span><span style="display:flex;"><span>cargo clean -p &lt;package&gt;		<span style="color:#75715e"># 清理該指名套件</span>
</span></span></code></pre></div><ul>
<li>也可以用<a href="https://rustwiki.org/zh-CN/cargo/commands/cargo-tree.html">tree指令</a>來看看到底裝了什麼？
<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/duplicate.png"
      
      
    />

    </picture>
</figure>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cargo tree --duplicate
</span></span></code></pre></div><h2 id="建立列印小工具---ww_print">建立列印小工具 - ww_print</h2>
<ul>
<li>我們先來仿製一個類似<a href="https://github.com/William-Weng/WWPrint">WWPrint</a>的列印巨集，來簡化打印位置資訊…</li>
<li>正所謂<a href="https://swiftpackageindex.com/William-Weng">「工欲善其事，必先利其器」</a>嘛…</li>
<li>在library/macros.rs寫入以下的內容，記得要在mod.rs加入該模組…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[macro_export]</span>
</span></span><span style="display:flex;"><span>macro_rules<span style="color:#f92672">!</span> ww_print {
</span></span><span style="display:flex;"><span>    (<span style="color:#75715e">$message</span>:<span style="color:#a6e22e">expr</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>        println!(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">[</span><span style="color:#e6db74">{file}</span><span style="color:#e6db74"> - </span><span style="color:#e6db74">{line}</span><span style="color:#e6db74">]</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{message}</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>            file <span style="color:#f92672">=</span> file!().green().bold(),
</span></span><span style="display:flex;"><span>            line <span style="color:#f92672">=</span> format!(<span style="color:#e6db74">&#34;line.</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, line!().to_string()).yellow().bold(),
</span></span><span style="display:flex;"><span>            message <span style="color:#f92672">=</span> <span style="color:#75715e">$message</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>然後我們在<code>main.rs</code>中使用一下…</li>
<li>記得一定要先裝<code>colored</code>套件，不然會有錯誤喲…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> colored::Colorize;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> library;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    ww_print!(<span style="color:#e6db74">&#34;Hello, world!&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>然後執行一下以下的指令，有沒有看到有顏色的檔名跟行數啊，是不是很好用啊…
<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/ww_print.png"
      
      
    />

    </picture>
</figure>
</li>
</ul>
<h2 id="建立api">建立API</h2>
<h3 id="建立第一支api">建立第一支API</h3>
<ul>
<li>首先先建立兩個檔案，一個叫config.rs，另一個叫model.rs…
<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/get_first.png"
      
      
    />

    </picture>
</figure>
</li>
<li>config.rs是放公用的常數設定檔…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">DEFAULT_PORT</span>: <span style="color:#66d9ef">u16</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">8080</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">LOCALHOST</span>: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;127.0.0.1&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">CSV_FOLDER_PATH</span>: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;document&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">UPLOAD_FOLDER_PATH</span>: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;upload&#34;</span>;
</span></span></code></pre></div><ul>
<li>model.rs是放參數模型，在rust常常使用模型來處理變數，反而不會直接去添加文字Key值來處理…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> serde::{Serialize};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[derive(Serialize)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Message</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> message: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> timestamp: <span style="color:#66d9ef">i64</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> date: String,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>我們要生成一個名叫<a href="https://5xcampus.com/posts/build-restful-api-with-actix-web">/first</a>的API，使用<a href="https://actix.rs/docs/">actix_web</a>…</li>
<li>接下來就是，該引用的引用，該抄的抄一抄，程式碼應該很好理解…</li>
<li>產生的結果就是顯示文字跟時間 / 日期，先能動再說…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::io::{Error};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> colored::Colorize;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::{get};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::{App, HttpServer, Responder, web};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> chrono::{Utc};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> local_ip_address::{local_ip};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> library;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> model;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> config;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::model::{Message};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::config::<span style="color:#f92672">*</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[get(</span><span style="color:#e6db74">&#34;/first&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">get_first_action</span>() -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> now <span style="color:#f92672">=</span> Utc::now();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> Message {
</span></span><span style="display:flex;"><span>        message: <span style="color:#e6db74">&#34;安安你好嗎？&#34;</span>.to_string(),
</span></span><span style="display:flex;"><span>        timestamp: <span style="color:#a6e22e">now</span>.timestamp_millis(),
</span></span><span style="display:flex;"><span>        date: <span style="color:#a6e22e">now</span>.to_rfc3339(),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(response)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">register_service</span>() -&gt; Result<span style="color:#f92672">&lt;</span>(), Error<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> current_ip <span style="color:#f92672">=</span> local_ip().unwrap_or_else(<span style="color:#f92672">|</span>_<span style="color:#f92672">|</span> <span style="color:#66d9ef">LOCALHOST</span>.parse().unwrap());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ww_print!(format!(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Starting server at </span><span style="color:#e6db74">{localhost}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{port}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Starting server at </span><span style="color:#e6db74">{ip}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{port}</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>        ip <span style="color:#f92672">=</span> current_ip,
</span></span><span style="display:flex;"><span>        port <span style="color:#f92672">=</span> <span style="color:#66d9ef">DEFAULT_PORT</span>,
</span></span><span style="display:flex;"><span>        localhost <span style="color:#f92672">=</span> <span style="color:#66d9ef">LOCALHOST</span>
</span></span><span style="display:flex;"><span>    ));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    HttpServer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        App::new().service(get_first_action)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    .bind(format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, current_ip, <span style="color:#66d9ef">DEFAULT_PORT</span>))<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>    .bind(format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#66d9ef">LOCALHOST</span>, <span style="color:#66d9ef">DEFAULT_PORT</span>))<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>    .run()
</span></span><span style="display:flex;"><span>    .<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[actix_web::main]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">main</span>() -&gt; Result<span style="color:#f92672">&lt;</span>(), Error<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    register_service().<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>大家可以用<a href="http://127.0.0.1:8080">http://127.0.0.1:8080</a>試試看…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cargo run
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/get_first_api.png"
      
      
    />

    </picture>
</figure>
</p>
<ul>
<li>在這邊要先說明的是<a href="https://rust-lang.tw/book-tw/ch19-05-macros.html">Macro - 巨集</a>的功能，就是<code>#[get(&quot;/first&quot;)]</code>跟<code>#[actix_web::main]</code>這兩個巨集…</li>
<li>這個功能在<a href="https://kaochenlong.com/2023/09/23/stack-and-heap.html">Rust</a>很常用到，很像Swift的<a href="https://github.com/William-Weng/WWUserDefaults">property wrapper功能</a>，簡化了很多樣板代碼的撰寫…</li>
<li>#[get(&quot;/first&quot;)]就是指使用GET執行get_first_action()這個函數…</li>
<li>#[actix_web::main]是指讓main()在編譯時<a href="https://ithelp.ithome.com.tw/articles/10252834">運行</a>非同步程式碼…
<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/get_first_cmd.png"
      
      
    />

    </picture>
</figure>
</li>
<li>另外就是<a href="https://tonydeng.github.io/2019/11/09/rust-closure-type/">閉包的問題 - Closure</a>，居然是以<a href="https://doc.rust-lang.org/book/ch13-01-closures.html"><code>「||」</code></a>來表示的，其實就是<a href="https://course.rs/logs/log.html">下面</a>這個樣子啦…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">fn</span>  <span style="color:#a6e22e">add_one_v1</span>   (x: <span style="color:#66d9ef">u32</span>) -&gt; <span style="color:#66d9ef">u32</span> { x <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> add_one_v2 <span style="color:#f92672">=</span> <span style="color:#f92672">|</span>x: <span style="color:#66d9ef">u32</span><span style="color:#f92672">|</span> -&gt; <span style="color:#66d9ef">u32</span> { x <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> };
</span></span></code></pre></div><h3 id="str--string--string">&amp;str / String / &amp;String</h3>
<ul>
<li>建議使用原則</li>
</ul>
<blockquote>
<ul>
<li>函數參數優先使用 &amp;str (字串切片 - stack / 固定大小，不可變)</li>
<li>需要修改時使用 String (所有權 - heap / 可變大小)</li>
<li>需要共享時使用 &amp;String (引用 - stack / 固定大小，不可變)</li>
</ul></blockquote>
<h3 id="看門狗">看門狗？</h3>
<ul>
<li>有沒有想過，每一次改寫程式碼後，都要關閉服務器，再<a href="https://sardo.work/2024/08/31/%E5%88%86%E4%BA%AB%E4%B8%80%E4%BA%9Brust%E7%9A%84%E4%BE%BF%E5%88%A9%E5%B0%8F%E5%A5%97%E4%BB%B6/">重新啟動</a>呢？有沒有自動會重新啟動功能呢？</li>
<li>有…它就是<a href="https://github.com/watchexec/cargo-watch">cargo-watch</a></li>
<li>安裝好之後，執行下列的指令，它就會…</li>
</ul>
<blockquote>
<ul>
<li>-c: 每次重新執行前清除控制台</li>
<li>-q: 使輸出更簡潔</li>
<li>-d 2: 設置 2 秒的延遲，避免過於頻繁的重新編譯</li>
<li>-x run: 執行 run 指令</li>
</ul></blockquote>
<video controls width="50%">
  <source src="/images/2025/rust-web-api/cargo_watch.mp4" type="video/mp4" />
</video>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cargo install cargo-watch
</span></span><span style="display:flex;"><span>cargo watch -c -q -d <span style="color:#ae81ff">2</span> -x run
</span></span></code></pre></div><h3 id="rust沒有defer怎麼辦那就自己做一個吧">Rust沒有Defer怎麼辦？那就自己做一個吧…</h3>
<ul>
<li>相信寫過Swift的同學們，應該很常用<a href="https://onevcat.com/2018/11/defer/"><code>defer</code></a>的功能吧？一種延時呼叫的功能，至少我個人很滿常用的，但是…Rust沒有，所以要自己做一個…</li>
<li>Rust也有類似defer功能，可以使用<a href="https://doc.rust-lang.org/std/mem/fn.drop.html"><code>std::mem::drop</code></a>來實現…</li>
<li>跟一般建立struct大同小異，主要是實現一個<code>Drop trait</code>，可以把它當成是一個swift的<a href="https://www.appcoda.com.tw/swift-protocol/"><code>protocol</code></a>，就先這樣類比吧…</li>
<li>Drop trait的fn drop()的功能是當struct被<code>drop</code>時，再執行<code>closure</code>，有點像<a href="https://medium.com/one-two-swift/arc-%E8%A8%98%E6%86%B6%E9%AB%94%E7%AE%A1%E7%90%86-weak-unowned-b3f5ae4239c7"><code>deinit</code></a>的行為，可以讓我們在struct被drop時，執行一些清理工作，例如關閉檔案、釋放資源等。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Defer</span><span style="color:#f92672">&lt;</span>F: FnMut()<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    closure: <span style="color:#a6e22e">F</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">impl</span><span style="color:#f92672">&lt;</span>F: FnMut()<span style="color:#f92672">&gt;</span> Defer<span style="color:#f92672">&lt;</span>F<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">new</span>(closure: <span style="color:#a6e22e">F</span>) -&gt; <span style="color:#a6e22e">Self</span> {
</span></span><span style="display:flex;"><span>        Self { closure }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">impl</span><span style="color:#f92672">&lt;</span>F: FnMut()<span style="color:#f92672">&gt;</span> Drop <span style="color:#66d9ef">for</span> Defer<span style="color:#f92672">&lt;</span>F<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">drop</span>(<span style="color:#f92672">&amp;</span><span style="color:#66d9ef">mut</span> self) {
</span></span><span style="display:flex;"><span>        (self.closure)();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>這裡我們可以試試看結果有沒有跟我們要的功能一致？</li>
<li>要注意的是，一定要給一個變數記下來，不然就沒有變數可以drop，也就沒有執行Defer closure的機會了。</li>
</ul>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/defer.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::model::{Message, Defer};
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[get(</span><span style="color:#e6db74">&#34;/first&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">get_first_action</span>() -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(<span style="color:#e6db74">&#34;執行Defer closure&#34;</span>);
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ww_print!(<span style="color:#e6db74">&#34;執行get_first_action&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="美化一下api的輸出log">美化一下API的輸出Log</h3>
<ul>
<li>為了讓API的輸出Log更易讀，我們可以使用<code>enum</code>的方法，順便加一些顏色 / 類型轉換的功能，方便辨識。</li>
<li>在<code>model.rs</code>再加一個名叫<code>HttpMethod</code>的enum…</li>
<li>有<code>&amp;self</code>參數的是一般函數 (.方法)，沒有的是static函數 (::方法)…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[derive(Debug)]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[allow(dead_code)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">HttpMethod</span> {
</span></span><span style="display:flex;"><span>    Get,
</span></span><span style="display:flex;"><span>    Post,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">impl</span> HttpMethod {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">as_str</span>(<span style="color:#f92672">&amp;</span>self) -&gt; <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">match</span> self {
</span></span><span style="display:flex;"><span>            HttpMethod::Get <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;Get&#34;</span>,
</span></span><span style="display:flex;"><span>            HttpMethod::Post <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#34;Post&#34;</span>,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">on_custom_color</span>(<span style="color:#f92672">&amp;</span>self) -&gt; <span style="color:#a6e22e">CustomColor</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">match</span> self {
</span></span><span style="display:flex;"><span>            HttpMethod::Get <span style="color:#f92672">=&gt;</span> CustomColor::new(<span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">226</span>, <span style="color:#ae81ff">18</span>),
</span></span><span style="display:flex;"><span>            HttpMethod::Post <span style="color:#f92672">=&gt;</span> CustomColor::new(<span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">250</span>),
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>細節就不多說了，主要是仿一些主流的Web框架的Log輸出，例如<a href="https://github.com/gin-gonic/gin/blob/master/logger.go">gin</a>、<a href="https://github.com/pallets/flask/blob/main/flask/logging.py">flask</a>等。</li>
<li>建立一個新的<code>library</code>，名叫<code>utility.rs</code>，記錄一下小工具，<code>程式碼</code>如下，記得要在mod.rs加入它喲…</li>
<li>這裡唯一要說明的東西，因為status_code會比_defer內的closure的生命週期短，需要宣告成<code>Cell</code>，然後使用<code>get</code>方法獲取值，也就是指標，當然也是要為了<code>單線程安全</code>。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#e6db74">/// library/utility.rs
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#66d9ef">use</span> std::cell::Cell;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> colored::Colorize;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::http::StatusCode;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::{HttpRequest};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> chrono::{Local};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::model::{HttpMethod};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">log_message</span>(request: <span style="color:#66d9ef">&amp;</span><span style="color:#a6e22e">HttpRequest</span>, status_code: <span style="color:#66d9ef">&amp;</span><span style="color:#a6e22e">Cell</span><span style="color:#f92672">&lt;</span>StatusCode<span style="color:#f92672">&gt;</span>, method: <span style="color:#a6e22e">HttpMethod</span>) -&gt; String {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> connection_info <span style="color:#f92672">=</span> request.connection_info().clone();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> client_ip <span style="color:#f92672">=</span> connection_info.peer_addr().unwrap_or(<span style="color:#e6db74">&#34;unknown&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> request_url <span style="color:#f92672">=</span> request.uri().to_string();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> status_code.get() {
</span></span><span style="display:flex;"><span>        code <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">500</span><span style="color:#f92672">..</span><span style="color:#ae81ff">600</span>).contains(<span style="color:#f92672">&amp;</span>code.as_u16()) <span style="color:#f92672">=&gt;</span> status_code.get().to_string().red(),
</span></span><span style="display:flex;"><span>        StatusCode::<span style="color:#66d9ef">OK</span> <span style="color:#f92672">=&gt;</span> status_code.get().to_string().green(),
</span></span><span style="display:flex;"><span>        _ <span style="color:#f92672">=&gt;</span> status_code.get().to_string().yellow(),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> fix_method <span style="color:#f92672">=</span> format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{:^5}</span><span style="color:#e6db74">&#34;</span>, method.as_str());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    format!(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{ip}</span><span style="color:#e6db74"> - [</span><span style="color:#e6db74">{date}</span><span style="color:#e6db74">] </span><span style="color:#e6db74">{method}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">{url}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{status}</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>        ip <span style="color:#f92672">=</span> client_ip.bold(),
</span></span><span style="display:flex;"><span>        date <span style="color:#f92672">=</span> Local::now().format(<span style="color:#e6db74">&#34;%d/%b/%Y %H:%M:%S&#34;</span>),
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> request_url.yellow(),
</span></span><span style="display:flex;"><span>        method <span style="color:#f92672">=</span> fix_method.on_custom_color(method.on_custom_color()),
</span></span><span style="display:flex;"><span>        status <span style="color:#f92672">=</span> status,
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#e6db74">/// library/mod.rs
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"></span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">mod</span> macros;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">mod</span> utility;
</span></span></code></pre></div><ul>
<li>現在我們就來試看看吧，是不是很有feel啊？</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> library;
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::library::utility::log_message;
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[get(</span><span style="color:#e6db74">&#34;/first&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">get_first_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> now <span style="color:#f92672">=</span> Utc::now();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Get));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> Message {
</span></span><span style="display:flex;"><span>        message: <span style="color:#e6db74">&#34;安安你好嗎？&#34;</span>.to_string(),
</span></span><span style="display:flex;"><span>        timestamp: <span style="color:#a6e22e">now</span>.timestamp_millis(),
</span></span><span style="display:flex;"><span>        date: <span style="color:#a6e22e">now</span>.to_rfc3339(),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(response)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/defer_test.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="取得query變數">取得Query變數</h3>
<ul>
<li>一般常常看到網址的尾端會加上<code>?id=123&amp;name=William</code>的字樣，這就是要取得的Query變數，可以把這些數值傳給Server端。</li>
<li>接下來我們就來試做一個簡單的Demo，加強它的功能…</li>
<li>先在<code>model.rs</code>新增一個<code>struct</code>，用來儲存<code>Query變數</code>的值，就是含有id和name兩個欄位，是可填可不填的<code>Option</code>欄位。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> serde::{Deserialize};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[derive(Deserialize)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Params</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> id: Option<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">i32</span><span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> name: Option<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>然後新增一個<code>/query</code>的API來取得<code>Query變數</code>的值，程式碼跟<code>/first</code>的差不多，只是多了一個處理query的值…</li>
<li>這裡使用match來處理query的值，因為是<code>可選的</code>，所以會有四種可能…</li>
<li>最後要記得註冊<code>get_query_action</code>喲…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::model::{Message, Defer, HttpMethod, Params};
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[get(</span><span style="color:#e6db74">&#34;/query&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">get_query_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, query: <span style="color:#a6e22e">web</span>::Query<span style="color:#f92672">&lt;</span>Params<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> now <span style="color:#f92672">=</span> Utc::now();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Get));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> message <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> (<span style="color:#f92672">&amp;</span>query.name, query.id) {
</span></span><span style="display:flex;"><span>        (Some(name), Some(id)) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;[Hello, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> (ID: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)!&#34;</span>, name, id),
</span></span><span style="display:flex;"><span>        (Some(name), None) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">!&#34;</span>, name),
</span></span><span style="display:flex;"><span>        (None, Some(id)) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, User </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">!&#34;</span>, id),
</span></span><span style="display:flex;"><span>        (None, None) <span style="color:#f92672">=&gt;</span> String::from(<span style="color:#e6db74">&#34;Hello, World!&#34;</span>),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> Message {
</span></span><span style="display:flex;"><span>        message: <span style="color:#a6e22e">message</span>.to_string(),
</span></span><span style="display:flex;"><span>        timestamp: <span style="color:#a6e22e">now</span>.timestamp_millis(),
</span></span><span style="display:flex;"><span>        date: <span style="color:#a6e22e">now</span>.to_rfc3339(),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(response)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">register_service</span>() -&gt; Result<span style="color:#f92672">&lt;</span>(), Error<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    HttpServer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>            App::new()
</span></span><span style="display:flex;"><span>                .service(get_first_action)
</span></span><span style="display:flex;"><span>                .service(get_query_action)
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>        .bind(format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, current_ip, <span style="color:#66d9ef">DEFAULT_PORT</span>))<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>        .bind(format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#66d9ef">LOCALHOST</span>, <span style="color:#66d9ef">DEFAULT_PORT</span>))<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>        .run()
</span></span><span style="display:flex;"><span>        .<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>最後，大家可以試試看<code>http://localhost:8080/query?id=987987&amp;name=William</code>這個API喲…</li>
</ul>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/get_query.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="取得body的值">取得Body的值</h3>
<ul>
<li>這裡主要是要取得Body的值，因為<code>GET</code>規定是沒有Body的，所以我們選用<code>POST</code>來做示範…</li>
<li>新增一個<code>/json</code>的API來取得<code>Body</code>的值，程式碼跟<code>/query</code>的差不多…</li>
<li>這裡我們直接使用<code>JSON字串</code>來當輸出值，使用<code>serde_json::from_str()</code>來把JSON字串轉成<code>Value</code>，一個可輸出的值…</li>
<li>這裡的<code>unwrap()</code>，其實就是Swift的<a href="https://www.appcoda.com.tw/swift-optional-intro/"><code>!</code></a>，強制解出其值…</li>
<li>最後還是要記得註冊<code>post_json_action</code>喲…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> serde_json::{Value};
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/json&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">post_json_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, input: <span style="color:#a6e22e">web</span>::Json<span style="color:#f92672">&lt;</span>Params<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> now <span style="color:#f92672">=</span> Utc::now();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> message <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> (<span style="color:#f92672">&amp;</span>input.name, input.id) {
</span></span><span style="display:flex;"><span>        (Some(name), Some(id)) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> (ID: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)!&#34;</span>, name, id),
</span></span><span style="display:flex;"><span>        (Some(name), None) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">!&#34;</span>, name),
</span></span><span style="display:flex;"><span>        (None, Some(id)) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, User </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">!&#34;</span>, id),
</span></span><span style="display:flex;"><span>        (None, None) <span style="color:#f92672">=&gt;</span> String::from(<span style="color:#e6db74">&#34;Hello, World!&#34;</span>),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> json <span style="color:#f92672">=</span> format!(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">r</span><span style="color:#e6db74">#&#34;{{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;message&#34;: &#34;{}&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;timestamp&#34;: {},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;date&#34;: &#34;{}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        }}&#34;#</span>,
</span></span><span style="display:flex;"><span>        message,
</span></span><span style="display:flex;"><span>        now.timestamp_millis(),
</span></span><span style="display:flex;"><span>        now.to_rfc3339()
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> parsed: <span style="color:#a6e22e">Value</span> <span style="color:#f92672">=</span> serde_json::from_str(<span style="color:#f92672">&amp;</span>json).unwrap();
</span></span><span style="display:flex;"><span>    web::Json(parsed).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><ul>
<li>再來就請大家再測測看啦…
<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/post_body.png"
      
      
    />

    </picture>
</figure>
</li>
</ul>
<h3 id="動態路由---dynamic-routing">動態路由 - Dynamic Routing</h3>
<ul>
<li>Body的值可以很容易的增加，那Query的值可以嗎？</li>
<li>可以的，<a href="https://ithelp.ithome.com.tw/articles/10304013"><code>Router</code></a>也是可以設定成<code>Path</code>的值，例如<code>/user/{id}/{name}</code>，這樣就可以根據不同的<a href="https://ithelp.ithome.com.tw/m/articles/10353296"><code>id</code> / <code>name</code></a>來取得不同的使用者資訊了。</li>
<li>比較要說明的是，我們直接使用<code>path: web::Path&lt;(String, String)&gt;</code>來接<code>id</code>和<code>name</code>，再用<a href="https://gongdear.com/articles/2020/12/28/1609152963317.html"><code>into_inner()</code></a>把值解開…</li>
<li>如果沒有用到的值，可以使用<a href="https://youtu.be/PAGxPjbwjTY"><code>_</code>或<code>_name</code></a>來命名，不然Rust會一直提示說這個值沒用到…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/user/{id}/{name}&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">post_router_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>(String, String)<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> (id, _name) <span style="color:#f92672">=</span> path.into_inner();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> serde_json::json!({
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;更新成功&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;timestamp&#34;</span>: <span style="color:#a6e22e">Utc</span>::now().timestamp_millis()
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(parsed).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><a href="https://baike.baidu.com/item/%E6%9C%89%E6%9C%A8%E6%9C%89/18332">有木有</a>，<a href="https://medium.com/web-design-zone/vue-router-dynamic-route%E5%8B%95%E6%85%8B%E8%B7%AF%E7%94%B1-8d8c8074bfcd"><code>動態路由 - Dynamic Routing</code></a>是不是很方便啊？</li>
<li>其實Rust也是有<a href="https://kaochenlong.com/2023/09/20/primitive-data-types-part-3.html"><code>tuple - 元組</code></a>的資料型態…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> user: (<span style="color:#66d9ef">i32</span>, <span style="color:#f92672">&amp;</span><span style="color:#66d9ef">str</span>, <span style="color:#66d9ef">bool</span>) <span style="color:#f92672">=</span> (<span style="color:#ae81ff">42</span>, <span style="color:#e6db74">&#34;hello&#34;</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> (name, age, is_active) <span style="color:#f92672">=</span> user;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>println!(<span style="color:#e6db74">&#34;第一個值: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, user.<span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>println!(<span style="color:#e6db74">&#34;第二個值: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, user.<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>println!(<span style="color:#e6db74">&#34;第三個值: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, user.<span style="color:#ae81ff">2</span>);
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/post_router.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="動態query">動態Query</h3>
<ul>
<li>其實動態Query也是可以的，特別適合用來測試用…</li>
<li>這裡使用<a href="https://rust-lang.tw/book-tw/ch08-03-hash-maps.html"><code>HashMap</code></a>來處理Query的值，用<a href="https://rust-lang.tw/book-tw/ch13-02-iterators.html"><code>iter()</code></a>把值一個個疊代出來…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::{App, HttpServer, HttpRequest, HttpResponse, Responder, web};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::collections::HashMap;
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/dynamic&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">dynamic_query</span>(request: <span style="color:#a6e22e">HttpRequest</span>, query: <span style="color:#a6e22e">web</span>::Query<span style="color:#f92672">&lt;</span>HashMap<span style="color:#f92672">&lt;</span>String, String<span style="color:#f92672">&gt;&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (key, value) <span style="color:#66d9ef">in</span> query.iter() {
</span></span><span style="display:flex;"><span>        println!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, key, value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    HttpResponse::Ok().json(query.into_inner())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/post_dynamic.png"
      
      
    />

    </picture>
</figure>
</p>
<h2 id="建立讀取csv檔的api">建立讀取CSV檔的API</h2>
<h3 id="讀取csv檔">讀取CSV檔</h3>
<ul>
<li>接下來要進入<a href="https://juejin.cn/post/7108743876659118117">正題</a>了，我們先讀取<code>Linux.csv</code>文件…</li>
<li>先建立的一個struct，名叫<code>CsvRecord</code>，用來儲存CSV檔單行的內容，欄位對應就在<a href="https://juejin.cn/post/7284221961621192759">程式碼</a>之中。</li>
<li>其中<code>#[derive(Serialize, Deserialize, Debug)]</code>的<a href="https://czyt.tech/post/using-serde-in-rust/"><code>Serialize</code></a>跟<a href="https://juejin.cn/post/7272730352711565327"><code>Deserialize</code></a>可以當成是Swift的<a href="https://jjeremy-xue.medium.com/swift-%E8%AA%AA%E8%AA%AA-codable-decodable-encodable-594b28ff3d49"><code>Codable = Decodable &amp; Encodable</code></a>，用來解/編JSON的<a href="https://rust-lang.tw/book-tw/ch05-03-method-syntax.html"><code>implementations</code></a>，而<code>Debug</code>就是允許打印出<a href="https://kaochenlong.com/2023/09/23/stack-and-heap.html">結構內容</a>的意思，Rust其實防得滿嚴格的。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[derive(Serialize, Deserialize, Debug)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">CsvRecord</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> name: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> notes: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> url: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> example: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> level: <span style="color:#66d9ef">u8</span>,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>然後使用<code>csv</code>套件的功能來讀取CSV檔…</li>
<li>程式碼應該也很好理解，主要是利用<a href="https://kaochenlong.com/2023/10/01/generics-in-rust.html"><code>泛型</code></a>來加強功能，只處理符合<code>DeserializeOwned - 可以解的</code>跟<code>Debug - 可列印</code>的<a href="https://askeing.github.io/rust-book/traits.html"><code>trait</code></a>約束，其實就是<a href="https://rust-lang.tw/book-tw/ch10-02-traits.html"><code>規範共同的行為</code></a>…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::fmt::Debug;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> csv::Reader;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> serde::de::DeserializeOwned;
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">parse_csv_file</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span>(file_path: String) -&gt; Result<span style="color:#f92672">&lt;</span>Vec<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span>, Error<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">where</span> T: <span style="color:#a6e22e">DeserializeOwned</span> <span style="color:#f92672">+</span> Debug {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">mut</span> records: Vec<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> Vec::new();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> opened_file <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> File::open(file_path) {
</span></span><span style="display:flex;"><span>        Err(error) <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">return</span> Err(error),
</span></span><span style="display:flex;"><span>        Ok(file) <span style="color:#f92672">=&gt;</span> file,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">mut</span> reader <span style="color:#f92672">=</span> Reader::from_reader(opened_file);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> result <span style="color:#66d9ef">in</span> reader.deserialize() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">match</span> result {
</span></span><span style="display:flex;"><span>            Err(error) <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">return</span> Err(error.into()),
</span></span><span style="display:flex;"><span>            Ok(record) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>                ww_print!(format!(<span style="color:#e6db74">&#34;解析到記錄: </span><span style="color:#e6db74">{:?}</span><span style="color:#e6db74">&#34;</span>, record));
</span></span><span style="display:flex;"><span>                records.push(record)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Ok(records)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>我們先試看看讀不讀得出來CSV的文件檔，就建立一個<code>/csv</code>的API打看看…</li>
<li>也可以把<code>filename</code>打錯，有做對應的錯誤處理，要更改status_code，要用<code>.set(StatusCode::OK);</code>才行喲…</li>
</ul>
<p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/csv_1.png"
      
      
    />

    </picture>
</figure>
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/csv&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">csv_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">NOT_FOUND</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Linux.csv&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> file_path <span style="color:#f92672">=</span> format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, config::<span style="color:#66d9ef">CSV_FOLDER_PATH</span>, filename);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> records: Vec<span style="color:#f92672">&lt;</span>CsvRecord<span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> parse_csv_file(file_path) {
</span></span><span style="display:flex;"><span>        Err(error) <span style="color:#f92672">=&gt;</span> {<span style="color:#960050;background-color:#1e0010">`</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> web::Json(serde_json::json!({ <span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#a6e22e">error</span>.to_string() }))
</span></span><span style="display:flex;"><span>                .customize()
</span></span><span style="display:flex;"><span>                .with_status(status_code.get());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Ok(records) <span style="color:#f92672">=&gt;</span> records,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    status_code.set(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    web::Json(serde_json::json!({})).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/csv_2.png"
      
      
    />

    </picture>
</figure>
</p>
<ul>
<li>不知道大家有沒有注意到，為什麼有<code>return</code>呢？之前不都沒有寫嗎？</li>
<li>Rust常用的是<code>隱式回傳</code>的寫法，就是<code>沒分號</code>的return，這是最後一行；而<code>顯式回傳</code>的寫法，就是一般的寫法，是不是很有趣啊？差一個分號就<a href="https://youtu.be/0qRHmEQ5T-0">差<del>很</del>大~</a>了…</li>
</ul>
<h3 id="轉成json格式輸出">轉成JSON格式輸出</h3>
<ul>
<li>再來就把結果轉成<a href="https://blog.csdn.net/aggresss/article/details/138357709">JSON格式</a>輸出…</li>
<li>恭喜你，<a href="https://youtu.be/DissPgQx_os"><code>踏出了成功的第一步</code></a>，後面還要處理各<a href="https://support.microsoft.com/zh-tw/office/%E5%BB%BA%E7%AB%8B%E6%88%96%E7%B7%A8%E8%BC%AF-csv-%E6%AA%94%E6%A1%88%E4%BB%A5%E5%8C%AF%E5%85%A5%E5%88%B0-outlook-4518d70d-8fe9-46ad-94fa-1494247193c7"><code>CSV檔欄位</code></a>不同的問題…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/csv&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">csv_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> serde_json::json!({ <span style="color:#e6db74">&#34;result&#34;</span>: <span style="color:#a6e22e">records</span> });
</span></span><span style="display:flex;"><span>    status_code.set(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(serde_json::json!(response)).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/csv_3.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="選擇csv文件">選擇CSV文件</h3>
<ul>
<li>現在，我們要利用變數來選擇CSV文件，並根據選擇的文件名稱讀取相應的CSV文件內容。</li>
<li>首先新增一個constant.rs檔案，並新增一個名叫<code>CsvFileType</code>的<code>enum</code>，也把<code>HttpMethod</code>移來這邊，相關的地方也要修正一下…</li>
<li>這個enum的功能就是要將<code>Linux.csv</code>跟<code>CrossPlatform.csv</code>這兩個檔名做分類，當然用1、2、3也是可以的…</li>
<li>然後再加上一個<code>自定義錯誤</code>類型，因為有可能會轉錯嘛，然後再把<code>std::fmt::Display</code>的trait特徵加到<code>CustomError</code>中，實現<code>fmt()</code>方法…</li>
<li>這個<a href="https://ithelp.ithome.com.tw/m/articles/10336897"><code>std::fmt::Display</code></a>可以把它類比成Swift的<a href="https://medium.com/@o.labib1995/swift-customstringconvertible-fe8f4ec7fb2c"><code>CustomStringConvertible</code></a>這個<code>Protocol</code>，自訂print輸出文字…</li>
<li>在print!()方法中的參數都要實作這個<code>fmt()</code>才能被印出來，以後應該會很常用到它，它都叫<code>Display</code>了嘛，可以想象成<code>print!(&quot;hello&quot;.fmt())</code>…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> colored::{CustomColor};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">CustomError</span> {
</span></span><span style="display:flex;"><span>    EmptyString,
</span></span><span style="display:flex;"><span>    ParseStringError,
</span></span><span style="display:flex;"><span>    InvalidType(String),
</span></span><span style="display:flex;"><span>    FileNotFound(String),
</span></span><span style="display:flex;"><span>    UnknownError,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">impl</span> std::fmt::Display <span style="color:#66d9ef">for</span> CustomError {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">fmt</span>(<span style="color:#f92672">&amp;</span>self, format: <span style="color:#66d9ef">&amp;</span><span style="color:#a6e22e">mut</span> std::fmt::Formatter) -&gt; <span style="color:#a6e22e">std</span>::fmt::Result {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">match</span> self {
</span></span><span style="display:flex;"><span>            CustomError::InvalidType(_type) <span style="color:#f92672">=&gt;</span> write!(format, <span style="color:#e6db74">&#34;無效的檔案類型: {}&#34;</span>, _type),
</span></span><span style="display:flex;"><span>            CustomError::EmptyString <span style="color:#f92672">=&gt;</span> write!(format, <span style="color:#e6db74">&#34;檔案類型不能為空&#34;</span>),
</span></span><span style="display:flex;"><span>            CustomError::UnknownError <span style="color:#f92672">=&gt;</span> write!(format, <span style="color:#e6db74">&#34;未知錯誤&#34;</span>),
</span></span><span style="display:flex;"><span>            CustomError::ParseStringError <span style="color:#f92672">=&gt;</span> write!(format, <span style="color:#e6db74">&#34;字串解析錯誤&#34;</span>),
</span></span><span style="display:flex;"><span>            CustomError::FileNotFound(path) <span style="color:#f92672">=&gt;</span> write!(format, <span style="color:#e6db74">&#34;檔案未找到: {}&#34;</span>, path),
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[derive(Debug)]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[allow(dead_code)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">HttpMethod</span> {
</span></span><span style="display:flex;"><span>    Get,
</span></span><span style="display:flex;"><span>    Post,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[derive(Debug)]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[allow(dead_code)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">CsvFileType</span> {
</span></span><span style="display:flex;"><span>    Linux,
</span></span><span style="display:flex;"><span>    CrossPlatform,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="可選的csv文件檔名">可選的CSV文件檔名</h3>
<ul>
<li>我們來改造一下<code>csv_action</code>函數，使其能夠處理不同的CSV檔案類型，例如Linux和CrossPlatform，並根據不同的檔案類型進行不同的處理…</li>
<li>API路徑加上一個可變Path參數<code>filename</code>，接下來就把<code>filename</code>跟自定義錯誤印出來看看吧，這樣是不是更加清楚錯什麼了啊？</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/csv/{filename}&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">csv_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> filename <span style="color:#f92672">=</span> path.into_inner();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> error <span style="color:#f92672">=</span> CustomError::ParseStringError;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ww_print!(format!(<span style="color:#e6db74">&#34;CSV檔名: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, filename));
</span></span><span style="display:flex;"><span>    ww_print!(format!(<span style="color:#e6db74">&#34;自定義錯誤: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, error));
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/csv_4.png"
      
      
    />

    </picture>
</figure>
</p>
<ul>
<li>再來我們希望將<code>filename</code>轉成<code>CsvFileType</code>，除了防止打錯字之外，用<code>enum</code>的話，可以用<a href="https://ithelp.ithome.com.tw/articles/10288698"><code>match (switch..case)</code></a>來處理，更加的方便…</li>
<li>就是跟Swift的enum一樣，字串轉enum…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::<span style="color:#66d9ef">str</span>::FromStr;
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::constant::{HttpMethod, CsvFileType};
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/csv/{filename}&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">csv_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> filename <span style="color:#f92672">=</span> path.into_inner();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// let file_type: CsvFileType = match filename.parse() {
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> file_type: <span style="color:#a6e22e">CsvFileType</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> CsvFileType::from_str(filename.as_str()) {
</span></span><span style="display:flex;"><span>        Ok(_type) <span style="color:#f92672">=&gt;</span> _type,
</span></span><span style="display:flex;"><span>        Err(error) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            ww_print!(format!(<span style="color:#e6db74">&#34;錯誤: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">. 預設為: Linux.csv&#34;</span>, error));
</span></span><span style="display:flex;"><span>            CsvFileType::Linux
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ww_print!(format!(<span style="color:#e6db74">&#34;轉換的類型: </span><span style="color:#e6db74">{:?}</span><span style="color:#e6db74">&#34;</span>, file_type));
</span></span><span style="display:flex;"><span>    ww_print!(format!(<span style="color:#e6db74">&#34;CSV檔名: </span><span style="color:#e6db74">{:?}</span><span style="color:#e6db74">&#34;</span>, file_type.as_str()));
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>執行之後會發現少了些什麼？是<a href="https://www.youtube.com/watch?v=sH9Yyf9i0pI"><code>CsvFileType::from_str()</code></a>，我加了<code>from_str()</code>…</li>
<li>這個是一個<code>std::str::FromStr</code>的trait的實現，就是一般會用來轉型的那個<code>parse()</code>方法…</li>
<li>除了是這樣用 - <code>&lt;filename&gt;.parse()</code>，也可以這樣用 - <code>CsvFileType::from_str(&lt;filename&gt;)</code>…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> colored::{Colorize, CustomColor};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::ww_print;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">impl</span> std::<span style="color:#66d9ef">str</span>::FromStr <span style="color:#66d9ef">for</span> CsvFileType {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span> Err <span style="color:#f92672">=</span> CustomError;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">from_str</span>(<span style="color:#66d9ef">str</span>: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span>) -&gt; Result<span style="color:#f92672">&lt;</span>Self, Self::Err<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ww_print!(format!(<span style="color:#e6db74">&#34;輸入的文字為: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#66d9ef">str</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">match</span> <span style="color:#66d9ef">str</span>.to_lowercase().as_str() {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;linux&#34;</span> <span style="color:#f92672">=&gt;</span> Ok(CsvFileType::Linux),
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;crossplatform&#34;</span> <span style="color:#f92672">=&gt;</span> Ok(CsvFileType::CrossPlatform),
</span></span><span style="display:flex;"><span>            _ <span style="color:#f92672">=&gt;</span> Err(CustomError::InvalidType(<span style="color:#66d9ef">str</span>.to_string())),
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/csv_5.png"
      
      
    />

    </picture>
</figure>
</p>
<ul>
<li>我們把加強後的程式碼再來跑看看 - <code>http://127.0.0.1:8080/csv/windows</code>…</li>
<li>是不是一模一樣，沒什麼變化啊？但是如果是用 - <code>http://127.0.0.1:8080/csv/CrossPlatform</code>呢？</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/csv/{filename}&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">csv_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">NOT_FOUND</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> filename <span style="color:#f92672">=</span> path.into_inner();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// let file_type: CsvFileType = match filename.parse() {
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> file_type: <span style="color:#a6e22e">CsvFileType</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> CsvFileType::from_str(filename.as_str()) {
</span></span><span style="display:flex;"><span>        Ok(_type) <span style="color:#f92672">=&gt;</span> _type,
</span></span><span style="display:flex;"><span>        Err(error) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            ww_print!(format!(<span style="color:#e6db74">&#34;錯誤: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">. 預設為: Linux.csv&#34;</span>, error));
</span></span><span style="display:flex;"><span>            CsvFileType::Linux
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> file_path: String <span style="color:#f92672">=</span> format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, config::<span style="color:#66d9ef">CSV_FOLDER_PATH</span>, file_type.as_str());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> records: Vec<span style="color:#f92672">&lt;</span>CsvRecord<span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> parse_csv_file(file_path) {
</span></span><span style="display:flex;"><span>        Err(error) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> web::Json(serde_json::json!({ <span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#a6e22e">error</span>.to_string() }))
</span></span><span style="display:flex;"><span>                .customize()
</span></span><span style="display:flex;"><span>                .with_status(status_code.get());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Ok(records) <span style="color:#f92672">=&gt;</span> records,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> serde_json::json!({ <span style="color:#e6db74">&#34;result&#34;</span>: <span style="color:#a6e22e">records</span> });
</span></span><span style="display:flex;"><span>    status_code.set(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(serde_json::json!(response)).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="反序列化欄位不一怎麼辦">反序列化欄位不一怎麼辦？</h3>
<ul>
<li>什麼？明明就有<code>CrossPlatform.csv</code>啊，為什麼會讀不出來呢？</li>
<li>原來是因為欄位名稱不一致，沒有<code>example</code>這一列，導致反序列化失敗，那要怎麼辦呢？</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;CSV deserialize error: record 1 (line: 2, byte: 33): missing field `example`&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>照一般的做法，應該會是<code>CsvFileType</code>的各類型，各去對一個<code>struct</code>，然後利用<code>泛型</code>去處理，但…<code>serde</code>有一個很有趣的處理方式…</li>
<li>我們先把多出來的欄位也加到<code>CsvRecord</code>上…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[derive(Serialize, Deserialize, Debug)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">CsvRecord</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> name: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> notes: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> url: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> level: <span style="color:#66d9ef">u8</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#[serde(skip_serializing_if = </span><span style="color:#e6db74">&#34;Option::is_none&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> example: Option<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#[serde(deserialize_with = </span><span style="color:#e6db74">&#34;deserialize_platform&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#[serde(default)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#[serde(skip_serializing_if = </span><span style="color:#e6db74">&#34;Vec::is_empty&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> platform: Vec<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>其中<code>#[serde(skip_serializing_if = &quot;Option::is_none&quot;)]</code>這個巨集，用來控制序列化時是否跳過<code>None</code>值的欄位，跟Go的套件<a href="https://ithelp.ithome.com.tw/m/articles/10244740"><code>gin</code></a>有點像…</li>
<li>也就是說，這一欄有就解出來，沒有也沒關係的意思啦，可以先單獨加上這行試試看，應該就可以沒問題了…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[serde(skip_serializing_if = </span><span style="color:#e6db74">&#34;Option::is_none&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> example: Option<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>,
</span></span></code></pre></div><ul>
<li>先說<code>#[serde(skip_serializing_if = &quot;Vec::is_empty&quot;)]</code>，就是它<a href="https://juejin.cn/post/7278597227786174475">可有可無</a>的意思…</li>
<li>再來就是<code>#[serde(default)]</code>，用<a href="https://www.cw.com.tw/article/5134047">人話</a>說，就是有預設值，是Vec<String>的Default::default() - 空Array…</li>
<li>這個<code>#[serde(deserialize_with = &quot;deserialize_platform&quot;)]</code>就是說，要反序列化時，要使用<code>deserialize_platform</code>函數來處理<code>platform</code>欄位的反序列化…</li>
<li>因為<code>platform</code>的值是長得像<code>Windows,macOS,Linux,Android,iOS</code>這樣子的字串，所以要更進一步加工成<code>Vec&lt;String&gt;</code>的樣子…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[serde(deserialize_with = </span><span style="color:#e6db74">&#34;deserialize_platform&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[serde(default)]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[serde(skip_serializing_if = </span><span style="color:#e6db74">&#34;Vec::is_empty&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> platform: Vec<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>,
</span></span></code></pre></div><ul>
<li>這個就是<code>deserialize_with</code>中要實作的函數，用來處理<code>platform</code>欄位的反序列化…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> serde::de::Deserializer;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">deserialize_platform</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">&#39;de</span>, D<span style="color:#f92672">&gt;</span>(deserializer: <span style="color:#a6e22e">D</span>) -&gt; Result<span style="color:#f92672">&lt;</span>Vec<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>, D::Error<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">where</span> D: <span style="color:#a6e22e">Deserializer</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">&#39;de</span><span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> s: String <span style="color:#f92672">=</span> String::deserialize(deserializer)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>    Ok(s.split(<span style="color:#e6db74">&#39;,&#39;</span>).map(<span style="color:#f92672">|</span>s<span style="color:#f92672">|</span> s.trim().to_string()).collect())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>附上完整的<a href="https://developer.mozilla.org/zh-TW/docs/Web/HTTP/Reference/Status/400"><code>model.rs</code></a>的程式碼…</li>
<li>這樣就完成了<code>platform</code>欄位的反序列化，我們再用<code>bruno</code>再<code>post</code>一次看看吧…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>http://127.0.0.1:8080/csv/CrossPlatform
</span></span><span style="display:flex;"><span>http://127.0.0.1:8080/csv/linux
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> serde::{Serialize, Deserialize};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> serde::de::Deserializer;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[derive(Serialize)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Message</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> message: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> timestamp: <span style="color:#66d9ef">i64</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> date: String,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[derive(Deserialize)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Params</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> id: Option<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">i32</span><span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> name: Option<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[derive(Serialize, Deserialize, Debug)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">CsvRecord</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> name: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> notes: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> url: String,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> level: <span style="color:#66d9ef">u8</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#[serde(skip_serializing_if = </span><span style="color:#e6db74">&#34;Option::is_none&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> example: Option<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#[serde(deserialize_with = </span><span style="color:#e6db74">&#34;deserialize_platform&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#[serde(default)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#[serde(skip_serializing_if = </span><span style="color:#e6db74">&#34;Vec::is_empty&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> platform: Vec<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">deserialize_platform</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">&#39;de</span>, D<span style="color:#f92672">&gt;</span>(deserializer: <span style="color:#a6e22e">D</span>) -&gt; Result<span style="color:#f92672">&lt;</span>Vec<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>, D::Error<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">where</span> D: <span style="color:#a6e22e">Deserializer</span><span style="color:#f92672">&lt;</span><span style="color:#a6e22e">&#39;de</span><span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">str</span> <span style="color:#f92672">=</span> String::deserialize(deserializer)<span style="color:#f92672">?</span>;
</span></span><span style="display:flex;"><span>    Ok(<span style="color:#66d9ef">str</span>.split(<span style="color:#e6db74">&#39;,&#39;</span>).map(<span style="color:#f92672">|</span><span style="color:#66d9ef">str</span><span style="color:#f92672">|</span> <span style="color:#66d9ef">str</span>.trim().to_string()).collect())
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Defer</span><span style="color:#f92672">&lt;</span>F: FnMut()<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    closure: <span style="color:#a6e22e">F</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">impl</span><span style="color:#f92672">&lt;</span>F: FnMut()<span style="color:#f92672">&gt;</span> Defer<span style="color:#f92672">&lt;</span>F<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">new</span>(closure: <span style="color:#a6e22e">F</span>) -&gt; <span style="color:#a6e22e">Self</span> {
</span></span><span style="display:flex;"><span>        Self { closure }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">impl</span><span style="color:#f92672">&lt;</span>F: FnMut()<span style="color:#f92672">&gt;</span> Drop <span style="color:#66d9ef">for</span> Defer<span style="color:#f92672">&lt;</span>F<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">drop</span>(<span style="color:#f92672">&amp;</span><span style="color:#66d9ef">mut</span> self) {
</span></span><span style="display:flex;"><span>        (self.closure)();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/csv_result_1.png"
      
      
    />

    </picture>
</figure>

<figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/csv_result_2.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="整理程式碼">整理程式碼</h3>
<ul>
<li>最後，我們把<code>main.rs</code>內的程式包裝成一個<code>service</code>，就放在<code>src/service/csv_service.rs</code>底下…</li>
<li>把程式跟Web路徑分開，看起來比較乾淨，日後也好維護…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::cell::Cell;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::collections::HashMap;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::<span style="color:#66d9ef">str</span>::FromStr;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::http::StatusCode;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::{HttpRequest, HttpResponse, Responder, web};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> chrono::{Utc};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> colored::Colorize;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> serde_json::{Value};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::library::utility::{log_message, parse_csv_file};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::model::<span style="color:#f92672">*</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::config;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::constant::{HttpMethod, CsvFileType};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::ww_print;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">get_first_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> now <span style="color:#f92672">=</span> Utc::now();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Get));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> Message {
</span></span><span style="display:flex;"><span>        message: <span style="color:#e6db74">&#34;安安你好嗎？&#34;</span>.to_string(),
</span></span><span style="display:flex;"><span>        timestamp: <span style="color:#a6e22e">now</span>.timestamp_millis(),
</span></span><span style="display:flex;"><span>        date: <span style="color:#a6e22e">now</span>.to_rfc3339(),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(response)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">get_query_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, query: <span style="color:#a6e22e">web</span>::Query<span style="color:#f92672">&lt;</span>Params<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> now <span style="color:#f92672">=</span> Utc::now();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Get));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> message <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> (<span style="color:#f92672">&amp;</span>query.name, query.id) {
</span></span><span style="display:flex;"><span>        (Some(name), Some(id)) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;[Hello, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> (ID: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)!&#34;</span>, name, id),
</span></span><span style="display:flex;"><span>        (Some(name), None) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">!&#34;</span>, name),
</span></span><span style="display:flex;"><span>        (None, Some(id)) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, User </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">!&#34;</span>, id),
</span></span><span style="display:flex;"><span>        (None, None) <span style="color:#f92672">=&gt;</span> String::from(<span style="color:#e6db74">&#34;Hello, World!&#34;</span>),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> Message {
</span></span><span style="display:flex;"><span>        message: <span style="color:#a6e22e">message</span>.to_string(),
</span></span><span style="display:flex;"><span>        timestamp: <span style="color:#a6e22e">now</span>.timestamp_millis(),
</span></span><span style="display:flex;"><span>        date: <span style="color:#a6e22e">now</span>.to_rfc3339(),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(response)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">post_json_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, input: <span style="color:#a6e22e">web</span>::Json<span style="color:#f92672">&lt;</span>Params<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> now <span style="color:#f92672">=</span> Utc::now();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> message <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> (<span style="color:#f92672">&amp;</span>input.name, input.id) {
</span></span><span style="display:flex;"><span>        (Some(name), Some(id)) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> (ID: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">)!&#34;</span>, name, id),
</span></span><span style="display:flex;"><span>        (Some(name), None) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">!&#34;</span>, name),
</span></span><span style="display:flex;"><span>        (None, Some(id)) <span style="color:#f92672">=&gt;</span> format!(<span style="color:#e6db74">&#34;Hello, User </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">!&#34;</span>, id),
</span></span><span style="display:flex;"><span>        (None, None) <span style="color:#f92672">=&gt;</span> String::from(<span style="color:#e6db74">&#34;Hello, World!&#34;</span>),
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> json <span style="color:#f92672">=</span> format!(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">r</span><span style="color:#e6db74">#&#34;{{
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;message&#34;: &#34;{}&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;timestamp&#34;: {},
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;date&#34;: &#34;{}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        }}&#34;#</span>,
</span></span><span style="display:flex;"><span>        message,
</span></span><span style="display:flex;"><span>        now.timestamp_millis(),
</span></span><span style="display:flex;"><span>        now.to_rfc3339()
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> parsed: <span style="color:#a6e22e">Value</span> <span style="color:#f92672">=</span> serde_json::from_str(<span style="color:#f92672">&amp;</span>json).unwrap();
</span></span><span style="display:flex;"><span>    web::Json(parsed).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">post_router_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>(String, String)<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> (id, _name) <span style="color:#f92672">=</span> path.into_inner();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> serde_json::json!({
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;更新成功&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;timestamp&#34;</span>: <span style="color:#a6e22e">Utc</span>::now().timestamp_millis()
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(response).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">dynamic_query</span>(request: <span style="color:#a6e22e">HttpRequest</span>, query: <span style="color:#a6e22e">web</span>::Query<span style="color:#f92672">&lt;</span>HashMap<span style="color:#f92672">&lt;</span>String, String<span style="color:#f92672">&gt;&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (key, value) <span style="color:#66d9ef">in</span> query.iter() {
</span></span><span style="display:flex;"><span>        println!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, key, value);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    HttpResponse::Ok().json(query.into_inner())
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">read_csv_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">NOT_FOUND</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> filename <span style="color:#f92672">=</span> path.into_inner();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// let file_type: CsvFileType = match filename.parse() {
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> file_type: <span style="color:#a6e22e">CsvFileType</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> CsvFileType::from_str(filename.as_str()) {
</span></span><span style="display:flex;"><span>        Ok(_type) <span style="color:#f92672">=&gt;</span> _type,
</span></span><span style="display:flex;"><span>        Err(error) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            ww_print!(format!(<span style="color:#e6db74">&#34;錯誤: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">. 預設為: Linux.csv&#34;</span>, error));
</span></span><span style="display:flex;"><span>            CsvFileType::Linux
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> file_path: String <span style="color:#f92672">=</span> format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, config::<span style="color:#66d9ef">CSV_FOLDER_PATH</span>, file_type.as_str());
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> records: Vec<span style="color:#f92672">&lt;</span>CsvRecord<span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> parse_csv_file(file_path) {
</span></span><span style="display:flex;"><span>        Err(error) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>            status_code.set(StatusCode::<span style="color:#66d9ef">BAD_REQUEST</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> web::Json(serde_json::json!({ <span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#a6e22e">error</span>.to_string() })).customize().with_status(status_code.get());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Ok(records) <span style="color:#f92672">=&gt;</span> records,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> response <span style="color:#f92672">=</span> serde_json::json!({ <span style="color:#e6db74">&#34;result&#34;</span>: <span style="color:#a6e22e">records</span> });
</span></span><span style="display:flex;"><span>    status_code.set(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    web::Json(serde_json::json!(response)).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>最後附上<code>main.rs</code>的程式碼，<a href="https://www.bilibili.com/video/BV1nT411e7vD/">完結撒花…</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::io::{Error};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> std::collections::HashMap;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> colored::Colorize;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::{get, post};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> actix_web::{App, HttpServer, HttpRequest, Responder, web};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> local_ip_address::{local_ip};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> library;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> model;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> config;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> constant;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">mod</span> service;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::model::Params;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::config::<span style="color:#f92672">*</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#66d9ef">crate</span>::{
</span></span><span style="display:flex;"><span>    service::csv_service <span style="color:#66d9ef">as</span> _service_,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[get(</span><span style="color:#e6db74">&#34;/first&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">get_first_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::get_first_action(request)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[get(</span><span style="color:#e6db74">&#34;/query&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">get_query_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, query: <span style="color:#a6e22e">web</span>::Query<span style="color:#f92672">&lt;</span>Params<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::get_query_action(request, query)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/json&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">post_json_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, input: <span style="color:#a6e22e">web</span>::Json<span style="color:#f92672">&lt;</span>Params<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::post_json_action(request, input)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/user/{id}/{name}&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">post_router_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>(String, String)<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::post_router_action(request, path)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/dynamic&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">dynamic_query</span>(request: <span style="color:#a6e22e">HttpRequest</span>, query: <span style="color:#a6e22e">web</span>::Query<span style="color:#f92672">&lt;</span>HashMap<span style="color:#f92672">&lt;</span>String, String<span style="color:#f92672">&gt;&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::dynamic_query(request, query)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/csv/{filename}&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">csv_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::read_csv_action(request, path)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">register_service</span>() -&gt; Result<span style="color:#f92672">&lt;</span>(), Error<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> current_ip <span style="color:#f92672">=</span> local_ip().unwrap_or_else(<span style="color:#f92672">|</span>_<span style="color:#f92672">|</span> <span style="color:#66d9ef">LOCALHOST</span>.parse().unwrap());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ww_print!(format!(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Starting server at </span><span style="color:#e6db74">{localhost}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{port}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Starting server at </span><span style="color:#e6db74">{ip}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{port}</span><span style="color:#e6db74">&#34;</span>,
</span></span><span style="display:flex;"><span>        ip <span style="color:#f92672">=</span> current_ip,
</span></span><span style="display:flex;"><span>        port <span style="color:#f92672">=</span> <span style="color:#66d9ef">DEFAULT_PORT</span>,
</span></span><span style="display:flex;"><span>        localhost <span style="color:#f92672">=</span> <span style="color:#66d9ef">LOCALHOST</span>
</span></span><span style="display:flex;"><span>    ));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    HttpServer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        App::new()
</span></span><span style="display:flex;"><span>            .service(get_first_action)
</span></span><span style="display:flex;"><span>            .service(get_query_action)
</span></span><span style="display:flex;"><span>            .service(post_json_action)
</span></span><span style="display:flex;"><span>            .service(dynamic_query)
</span></span><span style="display:flex;"><span>            .service(post_router_action)
</span></span><span style="display:flex;"><span>            .service(csv_action)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    .bind(format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, current_ip, <span style="color:#66d9ef">DEFAULT_PORT</span>))<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>    .bind(format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#66d9ef">LOCALHOST</span>, <span style="color:#66d9ef">DEFAULT_PORT</span>))<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>    .run()
</span></span><span style="display:flex;"><span>    .<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[actix_web::main]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">main</span>() -&gt; Result<span style="color:#f92672">&lt;</span>(), Error<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    register_service().<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="編譯二進制檔案">編譯二進制檔案</h2>
<ul>
<li>可以使用<code>cargo build</code>命令編譯二進制檔案，用<code>cargo run</code>命令執行二進制檔案。</li>
<li>如果是編譯<code>debug</code>版的，檔案會在<code>target/debug</code>目錄下。</li>
<li>如果是編譯<code>release</code>版的，檔案會在<code>target/release</code>目錄下。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cargo build                                             <span style="color:#75715e"># 編譯debug版</span>
</span></span><span style="display:flex;"><span>cargo run                                               <span style="color:#75715e"># 執行debug版</span>
</span></span><span style="display:flex;"><span>cargo build --release                                   <span style="color:#75715e"># 編譯release版</span>
</span></span><span style="display:flex;"><span>cargo run --release                                     <span style="color:#75715e"># 執行release版</span>
</span></span><span style="display:flex;"><span>cargo build --target aarch64-apple-darwin --release     <span style="color:#75715e"># 編譯aarch64-apple-darwin release版</span>
</span></span><span style="display:flex;"><span>cargo build --target x86_64-apple-darwin --release      <span style="color:#75715e"># 編譯x86_64-apple-darwin release版</span>
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/images/2025/rust-web-api/build.png"
      
      
    />

    </picture>
</figure>
</p>
<h2 id="檔案上傳下載">檔案上傳、下載</h2>
<h3 id="檔案上傳">檔案上傳</h3>
<ul>
<li>這裡呢，我們再補上<code>actix-files</code>跟<code>uuid</code>兩個套件…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span>[<span style="color:#a6e22e">dependencies</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">actix-files</span> = <span style="color:#e6db74">&#34;0.6.6&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">uuid</span> = { <span style="color:#a6e22e">version</span> = <span style="color:#e6db74">&#34;1.17.0&#34;</span>, <span style="color:#a6e22e">features</span> = [<span style="color:#e6db74">&#34;v4&#34;</span>] }
</span></span></code></pre></div><ul>
<li><code>actix-files</code>就是下載的功能；而<code>uuid</code>主要是防止上傳檔案<a href="https://youtu.be/rAOm--9JK1E">同名同姓</a>被蓋掉…</li>
<li>在這裡我們把檔案存在<code>upload</code>目錄下，記得在<code>constant.rs</code>加上<code>UPLOAD_FOLDER_PATH</code>變數，跟<code>新增資料夾</code>喲…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">UPLOAD_FOLDER_PATH</span>: <span style="color:#66d9ef">&amp;</span><span style="color:#66d9ef">str</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;upload&#34;</span>;
</span></span></code></pre></div><ul>
<li>程式碼如下，過程都是大同小異，就是看沒有有檔案，再把<code>uuid</code>.<code>副檔名</code>做為檔案的存取名稱…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">multi_upload_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, <span style="color:#66d9ef">mut</span> payload: <span style="color:#a6e22e">Multipart</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">BAD_REQUEST</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Post));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">let</span> Ok(Some(<span style="color:#66d9ef">mut</span> field)) <span style="color:#f92672">=</span> payload.try_next().<span style="color:#66d9ef">await</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> content_type <span style="color:#f92672">=</span> field.content_disposition();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> extension_name <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> content_type.get_filename() {
</span></span><span style="display:flex;"><span>            Some(filename) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">let</span> extension <span style="color:#f92672">=</span> Path::new(filename).extension().and_then(<span style="color:#f92672">|</span>ext<span style="color:#f92672">|</span> ext.to_str());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">match</span> extension {
</span></span><span style="display:flex;"><span>                    Some(ext) <span style="color:#f92672">=&gt;</span> ext.to_string(),
</span></span><span style="display:flex;"><span>                    None <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">return</span> web::Json(json!({<span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;無法取得檔案副檔名&#34;</span>})).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            None <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">return</span> web::Json(json!({<span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;無法取得檔案副檔名&#34;</span>})).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> filepath <span style="color:#f92672">=</span> format!(<span style="color:#e6db74">&#34;./</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, config::<span style="color:#66d9ef">UPLOAD_FOLDER_PATH</span>, Uuid::new_v4(), extension_name);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ww_print!(format!(<span style="color:#e6db74">&#34;檔案將儲存於: </span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, filepath));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">mut</span> file <span style="color:#f92672">=</span> <span style="color:#66d9ef">match</span> std::fs::File::create(<span style="color:#f92672">&amp;</span>filepath) {
</span></span><span style="display:flex;"><span>            Ok(file) <span style="color:#f92672">=&gt;</span> file,
</span></span><span style="display:flex;"><span>            Err(error) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>                status_code.set(StatusCode::<span style="color:#66d9ef">INTERNAL_SERVER_ERROR</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> web::Json(json!({<span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#a6e22e">format</span><span style="color:#f92672">!</span>(<span style="color:#e6db74">&#34;建立檔案失敗: {}&#34;</span>, error)})).customize().with_status(status_code.get());
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">let</span> Some(chunk) <span style="color:#f92672">=</span> field.next().<span style="color:#66d9ef">await</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">let</span> data <span style="color:#f92672">=</span> chunk.unwrap();
</span></span><span style="display:flex;"><span>            file.write_all(<span style="color:#f92672">&amp;</span>data).unwrap();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    status_code.set(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    web::Json(json!({<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;檔案上傳成功&#34;</span>, <span style="color:#e6db74">&#34;timestamp&#34;</span>: <span style="color:#a6e22e">Utc</span>::now().timestamp_millis()})).customize().with_status(status_code.get())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>要記得在<code>main.rs</code>註冊喲，就是加上<code>.service(upload_action)</code>…</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/upload&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">upload_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, payload: <span style="color:#a6e22e">Multipart</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::multi_upload_action(request, payload).<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/image/upload.png"
      
      
    />

    </picture>
</figure>
</p>
<h3 id="檔案下載">檔案下載</h3>
<ul>
<li>當然，能上傳就要能下載啊…</li>
<li>下載的程式碼就單純多了，就只要把<a href="https://ithelp.ithome.com.tw/articles/10251288">正確的URL</a>傳給瀏覽器，瀏覽器就會去下載檔案了…</li>
<li>其中有個叫<a href="https://openhome.cc/zh-tw/haskell/algebraic-data-type/maybe-either/"><code>Either</code></a>的enum，用來表示二選一的結果，兩個值都是正解，有點<a href="https://papermine.com/pub/3304"><code>「向左走，向右走」</code></a>的感覺。</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">pub</span> <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">download_file</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> status_code <span style="color:#f92672">=</span> Cell::new(StatusCode::<span style="color:#66d9ef">NOT_FOUND</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> _defer <span style="color:#f92672">=</span> Defer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        ww_print!(log_message(<span style="color:#f92672">&amp;</span>request, <span style="color:#f92672">&amp;</span>status_code, HttpMethod::Get));
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> filename <span style="color:#f92672">=</span> path.into_inner();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> filepath <span style="color:#f92672">=</span> PathBuf::from(format!(<span style="color:#e6db74">&#34;./</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, config::<span style="color:#66d9ef">UPLOAD_FOLDER_PATH</span>, filename));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">!</span>filepath.exists() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Either::Left(web::Json(json!({<span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;檔案不存在&#34;</span>})).customize().with_status(status_code.get()));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    status_code.set(StatusCode::<span style="color:#66d9ef">OK</span>);
</span></span><span style="display:flex;"><span>    Either::Right(NamedFile::open(filepath).unwrap())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>最後也請大家試試看吧，一般API會<a href="https://medium.com/%E7%A8%8B%E5%BC%8F%E7%8C%BF%E5%90%83%E9%A6%99%E8%95%89/%E5%86%8D%E6%8E%A2%E5%90%8C%E6%BA%90%E6%94%BF%E7%AD%96-%E8%AB%87-samesite-%E8%A8%AD%E5%AE%9A%E5%B0%8D-cookie-%E7%9A%84%E5%BD%B1%E9%9F%BF%E8%88%87%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85-6195d10d4441">用到的</a>功能都寫上了，是不是<a href="https://youtu.be/SQdTOJVEQhY">很佛心</a>啊？</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[post(</span><span style="color:#e6db74">&#34;/upload&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">upload_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, payload: <span style="color:#a6e22e">Multipart</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::multi_upload_action(request, payload).<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#[get(</span><span style="color:#e6db74">&#34;/download/{filename}&#34;</span><span style="color:#75715e">)]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">download_action</span>(request: <span style="color:#a6e22e">HttpRequest</span>, path: <span style="color:#a6e22e">web</span>::Path<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>) -&gt; <span style="color:#a6e22e">impl</span> Responder {
</span></span><span style="display:flex;"><span>    _service_::download_file(request, path).<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">fn</span> <span style="color:#a6e22e">register_service</span>() -&gt; Result<span style="color:#f92672">&lt;</span>(), Error<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> current_ip <span style="color:#f92672">=</span> local_ip().unwrap_or_else(<span style="color:#f92672">|</span>_<span style="color:#f92672">|</span> <span style="color:#66d9ef">LOCALHOST</span>.parse().unwrap());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ww_print!(format!(<span style="color:#e6db74">&#34;Starting server at </span><span style="color:#e6db74">{localhost}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{port}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Starting server at </span><span style="color:#e6db74">{ip}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{port}</span><span style="color:#e6db74">&#34;</span>, ip <span style="color:#f92672">=</span> current_ip, port <span style="color:#f92672">=</span> <span style="color:#66d9ef">DEFAULT_PORT</span>, localhost <span style="color:#f92672">=</span> <span style="color:#66d9ef">LOCALHOST</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    HttpServer::new(<span style="color:#f92672">||</span> {
</span></span><span style="display:flex;"><span>        App::new()
</span></span><span style="display:flex;"><span>            .service(get_first_action)
</span></span><span style="display:flex;"><span>            .service(get_query_action)
</span></span><span style="display:flex;"><span>            .service(post_json_action)
</span></span><span style="display:flex;"><span>            .service(dynamic_query)
</span></span><span style="display:flex;"><span>            .service(post_router_action)
</span></span><span style="display:flex;"><span>            .service(csv_action)
</span></span><span style="display:flex;"><span>            .service(upload_action)
</span></span><span style="display:flex;"><span>            .service(download_action)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    .bind(format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, current_ip, <span style="color:#66d9ef">DEFAULT_PORT</span>))<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>    .bind(format!(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">:</span><span style="color:#e6db74">{}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#66d9ef">LOCALHOST</span>, <span style="color:#66d9ef">DEFAULT_PORT</span>))<span style="color:#f92672">?</span>
</span></span><span style="display:flex;"><span>    .run()
</span></span><span style="display:flex;"><span>    .<span style="color:#66d9ef">await</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><figure>
  <picture>

    
      
        
        
        
        
        
        
    <img
      loading="lazy"
      decoding="async"
      alt=""
      
        class="image_figure image_internal image_unprocessed"
        src="https://William-Weng.github.io/image/download.png"
      
      
    />

    </picture>
</figure>
</p>
<h2 id="範例程式碼下載"><a href="/images/2025/rust-web-api/rust_csv_api.7z">範例程式碼下載</a></h2>
<h2 id="後記">後記</h2>
<ul>
<li>終於打完了，也感謝<a href="https://copilot.microsoft.com/"><code>Copilot</code></a>的幫忙，這篇應該筆者寫過最長的一篇吧？寫完之後，發現Rust還滿愛用<code>巨集</code>的，也許是為了速度吧，在<code>運算符號</code>上也為了分別，怕打錯字，也用了滿多其它語言沒有的，雖然說在Key的時候有點麻煩，但一眼就能看出是什麼意思。</li>
<li>沒想到Rust還真的是麻煩啊，如果用<a href="https://youtu.be/kcOeMrRll5c">Golang / Java / Python / Node.js</a>，開發速度一定是快得多的多了，不過做為一個下一代的C++，連<a href="https://www.techbang.com/posts/106699-ill-get-it-after-the-rest-of-the-article-today-instead-of-c">Windows 11的核心</a>也用它重寫了，雖然語法很麻煩，但就是…安全，連Google開始以Rust重寫<a href="https://www.ithome.com.tw/news/159204">Android裸機元件</a>，進一步強化記憶體安全性，還有<a href="https://kanru.info/libchewing-rust-rewrite-in-review/">新酷音輸入法</a>也用Rust重寫了，除了<a href="https://youtu.be/ONZZvc_IqQg">Linux群</a>之外，不過要無償的工程師去維護兩套程式碼，也是滿說不過去的啦…</li>
<li>其實啊，筆者也不是什麼<a href="https://nicechord.com/post/mozart-at-5/">天才</a>、<a href="https://tw.news.yahoo.com/%E7%B6%B2%E5%82%B3%E5%8D%B0%E5%BA%A6%E7%A5%9E%E7%AB%A5%E9%A0%90%E8%A8%80-%E5%8F%B0%E7%81%A3614%E5%87%8C%E6%99%A88-2%E5%9C%B0%E9%9C%87-%E9%98%BF%E5%8D%97%E5%BE%B7%E6%9C%AC%E4%BA%BA%E6%B0%A3%E7%82%B8%E6%8F%AD%E5%AF%A6%E6%83%85-090718793.html">神童</a>，更不是<a href="https://udn.com/news/story/6928/8243118">台清交</a>畢業的，只是個私立大學的小學生，不過經由一些<a href="https://swiftpackageindex.com/William-Weng">經驗的累積</a>，也許生長的很慢，但也是有所成長嘛…</li>
</ul>
    </div>
<div class="post_comments">
  
  
  
  
</div>




  </article>
<aside class="sidebar">
  <section class="sidebar_inner">
    <br>
    


    
    
    <h2 class="mt-4">Recent Posts</h2>
    <ul class="flex-column">
      <li>
        <a href="https://William-Weng.github.io/2025/06/tauri%E7%95%B6rust%E8%B7%9Fweb%E5%90%8C%E5%9C%A8%E4%B8%80%E8%B5%B7%E5%9C%A8%E4%B8%80%E8%B5%B7%E5%9C%A8%E4%B8%80%E8%B5%B7/" class="nav-link" title="【Tauri】當Rust跟Web同在一起，在一起，在一起…">【Tauri】當Rust跟Web同在一起，在一起，在一起…</a>
      </li>
      <li>
        <a href="https://William-Weng.github.io/2025/06/rustbruno%E6%88%91%E4%BE%86%E4%BA%86%E4%B8%80%E8%B5%B7%E4%BE%86%E6%89%93%E7%B6%B2%E8%B7%AFapi/" class="nav-link" title="【Rust】Bruno我來了，一起來打網路API…">【Rust】Bruno我來了，一起來打網路API…</a>
      </li>
      <li>
        <a href="https://William-Weng.github.io/2025/05/rust%E8%9E%83%E8%9F%B9%E4%B8%80%E5%91%80%E7%88%AA%E5%85%AB%E5%80%8B%E5%85%A9%E9%A0%AD%E5%B0%96%E5%B0%96%E9%80%99%E9%BA%BC%E5%A4%A7%E7%9A%84%E5%80%8B/" class="nav-link" title="【Rust】螃蟹一呀爪八個，兩頭尖尖，這麼大的個…">【Rust】螃蟹一呀爪八個，兩頭尖尖，這麼大的個…</a>
      </li>
      <li>
        <a href="https://William-Weng.github.io/2025/04/wails%E4%B8%80%E8%B5%B7%E4%BE%86%E5%81%9A%E5%80%8B%E6%A1%8C%E9%9D%A2%E7%A8%8B%E5%BC%8F%E5%B0%8F%E5%B7%A5%E5%85%B7%E5%90%A7/" class="nav-link" title="【Wails】一起來做個桌面程式小工具吧…">【Wails】一起來做個桌面程式小工具吧…</a>
      </li>
      <li>
        <a href="https://William-Weng.github.io/2025/01/docker%E5%AE%B9%E5%99%A8%E5%A4%A7%E5%AE%B6%E4%B8%80%E8%B5%B7%E4%BE%86%E7%95%B6%E9%AF%A8%E9%AD%9A%E6%90%AC%E9%81%8B%E5%B7%A5%E5%90%A7/" class="nav-link" title="【Docker容器】大家一起來當鯨魚搬運工吧…">【Docker容器】大家一起來當鯨魚搬運工吧…</a>
      </li>
      <li>
        <a href="https://William-Weng.github.io/2025/01/%E4%B8%B2%E6%B5%81%E5%BD%B1%E9%9F%B3%E5%A4%A7%E5%AE%B6%E4%B8%80%E8%B5%B7%E4%BE%86%E7%95%B6%E7%9B%B4%E6%92%AD%E4%B8%BB%E5%90%A7/" class="nav-link" title="【串流影音】大家一起來當直播主吧…">【串流影音】大家一起來當直播主吧…</a>
      </li>
      <li>
        <a href="https://William-Weng.github.io/2025/01/eop%E7%B0%A1%E8%AD%9C%E5%A4%A7%E5%B8%AB%E8%AE%93%E6%88%91%E5%80%91%E4%B8%80%E8%B5%B7%E6%88%90%E7%82%BA%E5%A4%A7%E5%B8%AB%E5%90%A7/" class="nav-link" title="【EOP簡譜大師】讓我們一起成為大師吧…">【EOP簡譜大師】讓我們一起成為大師吧…</a>
      </li>
      <li>
        <a href="https://William-Weng.github.io/2024/11/musescore-4%E8%BA%AB%E7%82%BA%E4%B8%80%E5%80%8B%E6%89%93%E5%AD%97%E5%B7%A5%E6%9C%83%E6%89%93%E4%BA%94%E7%B7%9A%E8%AD%9C%E4%B9%9F%E6%98%AF%E6%BB%BF%E6%AD%A3%E5%B8%B8%E7%9A%84%E5%98%9B/" class="nav-link" title="【MuseScore 4】身為一個打字工，會打五線譜也是滿正常的嘛…">【MuseScore 4】身為一個打字工，會打五線譜也是滿正常的嘛…</a>
      </li>
    </ul>
    <div>
      <h2 class="mt-4 taxonomy" id="tags-section">Tags</h2>
      <nav class="tags_nav">
        <a href='https://William-Weng.github.io/tags/swift/' class="post_tag button button_translucent" title="swift">
          SWIFT
          <span class="button_tally">15</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/xcode/' class="post_tag button button_translucent" title="xcode">
          XCODE
          <span class="button_tally">15</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/ios/' class="post_tag button button_translucent" title="ios">
          IOS
          <span class="button_tally">14</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/android/' class="post_tag button button_translucent" title="android">
          ANDROID
          <span class="button_tally">12</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/flutter/' class="post_tag button button_translucent" title="flutter">
          FLUTTER
          <span class="button_tally">11</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/golang/' class="post_tag button button_translucent" title="golang">
          GOLANG
          <span class="button_tally">10</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/game/' class="post_tag button button_translucent" title="game">
          GAME
          <span class="button_tally">9</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/install/' class="post_tag button button_translucent" title="install">
          INSTALL
          <span class="button_tally">8</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/backend/' class="post_tag button button_translucent" title="backend">
          BACKEND
          <span class="button_tally">7</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/database/' class="post_tag button button_translucent" title="database">
          DATABASE
          <span class="button_tally">7</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/vue/' class="post_tag button button_translucent" title="vue">
          VUE
          <span class="button_tally">7</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/dart/' class="post_tag button button_translucent" title="dart">
          DART
          <span class="button_tally">6</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/firebase/' class="post_tag button button_translucent" title="firebase">
          FIREBASE
          <span class="button_tally">6</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/javascript/' class="post_tag button button_translucent" title="javascript">
          JAVASCRIPT
          <span class="button_tally">6</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/api/' class="post_tag button button_translucent" title="api">
          API
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/c%23/' class="post_tag button button_translucent" title="c#">
          C#
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/mysql/' class="post_tag button button_translucent" title="mysql">
          MYSQL
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/unity/' class="post_tag button button_translucent" title="unity">
          UNITY
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/web/' class="post_tag button button_translucent" title="web">
          WEB
          <span class="button_tally">5</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/nodejs/' class="post_tag button button_translucent" title="nodejs">
          NODEJS
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/nosql/' class="post_tag button button_translucent" title="nosql">
          NOSQL
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/sqlite/' class="post_tag button button_translucent" title="sqlite">
          SQLITE
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/typescript/' class="post_tag button button_translucent" title="typescript">
          TYPESCRIPT
          <span class="button_tally">4</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/android-studio/' class="post_tag button button_translucent" title="android studio">
          ANDROID STUDIO
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/cargo/' class="post_tag button button_translucent" title="cargo">
          CARGO
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/html/' class="post_tag button button_translucent" title="html">
          HTML
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/kotlin/' class="post_tag button button_translucent" title="kotlin">
          KOTLIN
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/layout/' class="post_tag button button_translucent" title="layout">
          LAYOUT
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/linux/' class="post_tag button button_translucent" title="linux">
          LINUX
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/push/' class="post_tag button button_translucent" title="push">
          PUSH
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/rust/' class="post_tag button button_translucent" title="rust">
          RUST
          <span class="button_tally">3</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/csv/' class="post_tag button button_translucent" title="csv">
          CSV
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/debug/' class="post_tag button button_translucent" title="debug">
          DEBUG
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/docker/' class="post_tag button button_translucent" title="docker">
          DOCKER
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/email/' class="post_tag button button_translucent" title="email">
          EMAIL
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/ffmpeg/' class="post_tag button button_translucent" title="ffmpeg">
          FFMPEG
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/framework/' class="post_tag button button_translucent" title="framework">
          FRAMEWORK
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/gdscript/' class="post_tag button button_translucent" title="gdscript">
          GDSCRIPT
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/github/' class="post_tag button button_translucent" title="github">
          GITHUB
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/godot/' class="post_tag button button_translucent" title="godot">
          GODOT
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/grails/' class="post_tag button button_translucent" title="grails">
          GRAILS
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/groovy/' class="post_tag button button_translucent" title="groovy">
          GROOVY
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/heroku/' class="post_tag button button_translucent" title="heroku">
          HEROKU
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/image/' class="post_tag button button_translucent" title="image">
          IMAGE
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/java/' class="post_tag button button_translucent" title="java">
          JAVA
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/listview/' class="post_tag button button_translucent" title="listview">
          LISTVIEW
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/macos/' class="post_tag button button_translucent" title="macos">
          MACOS
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/music/' class="post_tag button button_translucent" title="music">
          MUSIC
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/nativescript/' class="post_tag button button_translucent" title="nativescript">
          NATIVESCRIPT
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/scorewriter/' class="post_tag button button_translucent" title="scorewriter">
          SCOREWRITER
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/sheet/' class="post_tag button button_translucent" title="sheet">
          SHEET
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/swiftui/' class="post_tag button button_translucent" title="swiftui">
          SWIFTUI
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/tools/' class="post_tag button button_translucent" title="tools">
          TOOLS
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/ubuntu/' class="post_tag button button_translucent" title="ubuntu">
          UBUNTU
          <span class="button_tally">2</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/2d/' class="post_tag button button_translucent" title="2d">
          2D
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/3d/' class="post_tag button button_translucent" title="3d">
          3D
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/3rd/' class="post_tag button button_translucent" title="3rd">
          3RD
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/ai/' class="post_tag button button_translucent" title="ai">
          AI
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/apns/' class="post_tag button button_translucent" title="apns">
          APNS
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/apollo/' class="post_tag button button_translucent" title="apollo">
          APOLLO
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/ar/' class="post_tag button button_translucent" title="ar">
          AR
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/audio/' class="post_tag button button_translucent" title="audio">
          AUDIO
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/bash/' class="post_tag button button_translucent" title="bash">
          BASH
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/blog/' class="post_tag button button_translucent" title="blog">
          BLOG
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/button/' class="post_tag button button_translucent" title="button">
          BUTTON
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/ca/' class="post_tag button button_translucent" title="ca">
          CA
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/chat/' class="post_tag button button_translucent" title="chat">
          CHAT
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/chatgpt/' class="post_tag button button_translucent" title="chatgpt">
          CHATGPT
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/cheatsheet/' class="post_tag button button_translucent" title="cheatsheet">
          CHEATSHEET
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/color/' class="post_tag button button_translucent" title="color">
          COLOR
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/combine/' class="post_tag button button_translucent" title="combine">
          COMBINE
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/container/' class="post_tag button button_translucent" title="container">
          CONTAINER
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/decrypt/' class="post_tag button button_translucent" title="decrypt">
          DECRYPT
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/encrypt/' class="post_tag button button_translucent" title="encrypt">
          ENCRYPT
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/eop/' class="post_tag button button_translucent" title="eop">
          EOP
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/fcm/' class="post_tag button button_translucent" title="fcm">
          FCM
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/firealpaca/' class="post_tag button button_translucent" title="firealpaca">
          FIREALPACA
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/gmt/' class="post_tag button button_translucent" title="gmt">
          GMT
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/graphql/' class="post_tag button button_translucent" title="graphql">
          GRAPHQL
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/hexo/' class="post_tag button button_translucent" title="hexo">
          HEXO
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/hls/' class="post_tag button button_translucent" title="hls">
          HLS
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/homebrew/' class="post_tag button button_translucent" title="homebrew">
          HOMEBREW
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/hotkey/' class="post_tag button button_translucent" title="hotkey">
          HOTKEY
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/jwt/' class="post_tag button button_translucent" title="jwt">
          JWT
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/koa2/' class="post_tag button button_translucent" title="koa2">
          KOA2
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/love2d/' class="post_tag button button_translucent" title="love2d">
          LOVE2D
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/lua/' class="post_tag button button_translucent" title="lua">
          LUA
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/magic/' class="post_tag button button_translucent" title="magic">
          MAGIC
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/mariadb/' class="post_tag button button_translucent" title="mariadb">
          MARIADB
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/mas-cli/' class="post_tag button button_translucent" title="mas-cli">
          MAS-CLI
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/mongodb/' class="post_tag button button_translucent" title="mongodb">
          MONGODB
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/musescore/' class="post_tag button button_translucent" title="musescore">
          MUSESCORE
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/nginx/' class="post_tag button button_translucent" title="nginx">
          NGINX
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/npm/' class="post_tag button button_translucent" title="npm">
          NPM
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/photoshop/' class="post_tag button button_translucent" title="photoshop">
          PHOTOSHOP
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/raspberry-pi/' class="post_tag button button_translucent" title="raspberry-pi">
          RASPBERRY-PI
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/rdbms/' class="post_tag button button_translucent" title="rdbms">
          RDBMS
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/regex/' class="post_tag button button_translucent" title="regex">
          REGEX
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/rtmp/' class="post_tag button button_translucent" title="rtmp">
          RTMP
          <span class="button_tally">1</span>
        </a>
        
        <a href='https://William-Weng.github.io/tags/rx/' class="post_tag button button_translucent" title="rx">
          RX
          <span class="button_tally">1</span>
        </a>
        
        
        <br>
        <div class="post_tags_toggle button">All Tags</div>
        <div class="post_tags">
          <div class="tags_list">
            
            <a href='https://William-Weng.github.io/tags/2d/' class=" post_tag button button_translucent" data-position=1 title="2d">2D<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/3d/' class=" post_tag button button_translucent" data-position=1 title="3d">3D<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/3rd/' class=" post_tag button button_translucent" data-position=1 title="3rd">3RD<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/ai/' class=" post_tag button button_translucent" data-position=1 title="ai">AI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/android/' class=" post_tag button button_translucent" data-position=12 title="android">ANDROID<span class="button_tally">12</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/android-studio/' class=" post_tag button button_translucent" data-position=3 title="android studio">ANDROID STUDIO<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/api/' class=" post_tag button button_translucent" data-position=5 title="api">API<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/apns/' class=" post_tag button button_translucent" data-position=1 title="apns">APNS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/apollo/' class=" post_tag button button_translucent" data-position=1 title="apollo">APOLLO<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/ar/' class=" post_tag button button_translucent" data-position=1 title="ar">AR<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/audio/' class=" post_tag button button_translucent" data-position=1 title="audio">AUDIO<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/backend/' class=" post_tag button button_translucent" data-position=7 title="backend">BACKEND<span class="button_tally">7</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/bash/' class=" post_tag button button_translucent" data-position=1 title="bash">BASH<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/blog/' class=" post_tag button button_translucent" data-position=1 title="blog">BLOG<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/button/' class=" post_tag button button_translucent" data-position=1 title="button">BUTTON<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/c%23/' class=" post_tag button button_translucent" data-position=5 title="c#">C#<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/ca/' class=" post_tag button button_translucent" data-position=1 title="ca">CA<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/cargo/' class=" post_tag button button_translucent" data-position=3 title="cargo">CARGO<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/chat/' class=" post_tag button button_translucent" data-position=1 title="chat">CHAT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/chatgpt/' class=" post_tag button button_translucent" data-position=1 title="chatgpt">CHATGPT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/cheatsheet/' class=" post_tag button button_translucent" data-position=1 title="cheatsheet">CHEATSHEET<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/color/' class=" post_tag button button_translucent" data-position=1 title="color">COLOR<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/combine/' class=" post_tag button button_translucent" data-position=1 title="combine">COMBINE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/container/' class=" post_tag button button_translucent" data-position=1 title="container">CONTAINER<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/csv/' class=" post_tag button button_translucent" data-position=2 title="csv">CSV<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/dart/' class=" post_tag button button_translucent" data-position=6 title="dart">DART<span class="button_tally">6</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/database/' class=" post_tag button button_translucent" data-position=7 title="database">DATABASE<span class="button_tally">7</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/debug/' class=" post_tag button button_translucent" data-position=2 title="debug">DEBUG<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/decrypt/' class=" post_tag button button_translucent" data-position=1 title="decrypt">DECRYPT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/docker/' class=" post_tag button button_translucent" data-position=2 title="docker">DOCKER<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/email/' class=" post_tag button button_translucent" data-position=2 title="email">EMAIL<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/encrypt/' class=" post_tag button button_translucent" data-position=1 title="encrypt">ENCRYPT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/eop/' class=" post_tag button button_translucent" data-position=1 title="eop">EOP<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/fcm/' class=" post_tag button button_translucent" data-position=1 title="fcm">FCM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/ffmpeg/' class=" post_tag button button_translucent" data-position=2 title="ffmpeg">FFMPEG<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/firealpaca/' class=" post_tag button button_translucent" data-position=1 title="firealpaca">FIREALPACA<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/firebase/' class=" post_tag button button_translucent" data-position=6 title="firebase">FIREBASE<span class="button_tally">6</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/flutter/' class=" post_tag button button_translucent" data-position=11 title="flutter">FLUTTER<span class="button_tally">11</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/framework/' class=" post_tag button button_translucent" data-position=2 title="framework">FRAMEWORK<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/game/' class=" post_tag button button_translucent" data-position=9 title="game">GAME<span class="button_tally">9</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/gdscript/' class=" post_tag button button_translucent" data-position=2 title="gdscript">GDSCRIPT<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/github/' class=" post_tag button button_translucent" data-position=2 title="github">GITHUB<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/gmt/' class=" post_tag button button_translucent" data-position=1 title="gmt">GMT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/godot/' class=" post_tag button button_translucent" data-position=2 title="godot">GODOT<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/golang/' class=" post_tag button button_translucent" data-position=10 title="golang">GOLANG<span class="button_tally">10</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/grails/' class=" post_tag button button_translucent" data-position=2 title="grails">GRAILS<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/graphql/' class=" post_tag button button_translucent" data-position=1 title="graphql">GRAPHQL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/groovy/' class=" post_tag button button_translucent" data-position=2 title="groovy">GROOVY<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/heroku/' class=" post_tag button button_translucent" data-position=2 title="heroku">HEROKU<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/hexo/' class=" post_tag button button_translucent" data-position=1 title="hexo">HEXO<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/hls/' class=" post_tag button button_translucent" data-position=1 title="hls">HLS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/homebrew/' class=" post_tag button button_translucent" data-position=1 title="homebrew">HOMEBREW<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/hotkey/' class=" post_tag button button_translucent" data-position=1 title="hotkey">HOTKEY<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/html/' class=" post_tag button button_translucent" data-position=3 title="html">HTML<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/image/' class=" post_tag button button_translucent" data-position=2 title="image">IMAGE<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/install/' class=" post_tag button button_translucent" data-position=8 title="install">INSTALL<span class="button_tally">8</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/ios/' class=" post_tag button button_translucent" data-position=14 title="ios">IOS<span class="button_tally">14</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/java/' class=" post_tag button button_translucent" data-position=2 title="java">JAVA<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/javascript/' class=" post_tag button button_translucent" data-position=6 title="javascript">JAVASCRIPT<span class="button_tally">6</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/jwt/' class=" post_tag button button_translucent" data-position=1 title="jwt">JWT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/koa2/' class=" post_tag button button_translucent" data-position=1 title="koa2">KOA2<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/kotlin/' class=" post_tag button button_translucent" data-position=3 title="kotlin">KOTLIN<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/layout/' class=" post_tag button button_translucent" data-position=3 title="layout">LAYOUT<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/linux/' class=" post_tag button button_translucent" data-position=3 title="linux">LINUX<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/listview/' class=" post_tag button button_translucent" data-position=2 title="listview">LISTVIEW<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/love2d/' class=" post_tag button button_translucent" data-position=1 title="love2d">LOVE2D<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/lua/' class=" post_tag button button_translucent" data-position=1 title="lua">LUA<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/macos/' class=" post_tag button button_translucent" data-position=2 title="macos">MACOS<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/magic/' class=" post_tag button button_translucent" data-position=1 title="magic">MAGIC<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/mariadb/' class=" post_tag button button_translucent" data-position=1 title="mariadb">MARIADB<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/mas-cli/' class=" post_tag button button_translucent" data-position=1 title="mas-cli">MAS-CLI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/mongodb/' class=" post_tag button button_translucent" data-position=1 title="mongodb">MONGODB<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/musescore/' class=" post_tag button button_translucent" data-position=1 title="musescore">MUSESCORE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/music/' class=" post_tag button button_translucent" data-position=2 title="music">MUSIC<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/mysql/' class=" post_tag button button_translucent" data-position=5 title="mysql">MYSQL<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/nativescript/' class=" post_tag button button_translucent" data-position=2 title="nativescript">NATIVESCRIPT<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/nginx/' class=" post_tag button button_translucent" data-position=1 title="nginx">NGINX<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/nodejs/' class=" post_tag button button_translucent" data-position=4 title="nodejs">NODEJS<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/nosql/' class=" post_tag button button_translucent" data-position=4 title="nosql">NOSQL<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/npm/' class=" post_tag button button_translucent" data-position=1 title="npm">NPM<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/photoshop/' class=" post_tag button button_translucent" data-position=1 title="photoshop">PHOTOSHOP<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/push/' class=" post_tag button button_translucent" data-position=3 title="push">PUSH<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/raspberry-pi/' class=" post_tag button button_translucent" data-position=1 title="raspberry-pi">RASPBERRY-PI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/rdbms/' class=" post_tag button button_translucent" data-position=1 title="rdbms">RDBMS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/regex/' class=" post_tag button button_translucent" data-position=1 title="regex">REGEX<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/rtmp/' class=" post_tag button button_translucent" data-position=1 title="rtmp">RTMP<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/rust/' class=" post_tag button button_translucent" data-position=3 title="rust">RUST<span class="button_tally">3</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/rx/' class=" post_tag button button_translucent" data-position=1 title="rx">RX<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/scorewriter/' class=" post_tag button button_translucent" data-position=2 title="scorewriter">SCOREWRITER<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/script/' class=" post_tag button button_translucent" data-position=1 title="script">SCRIPT<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/sheet/' class=" post_tag button button_translucent" data-position=2 title="sheet">SHEET<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/shell/' class=" post_tag button button_translucent" data-position=1 title="shell">SHELL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/sms/' class=" post_tag button button_translucent" data-position=1 title="sms">SMS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/sqlite/' class=" post_tag button button_translucent" data-position=4 title="sqlite">SQLITE<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/ssl/' class=" post_tag button button_translucent" data-position=1 title="ssl">SSL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/swift/' class=" post_tag button button_translucent" data-position=15 title="swift">SWIFT<span class="button_tally">15</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/swiftui/' class=" post_tag button button_translucent" data-position=2 title="swiftui">SWIFTUI<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/tauri/' class=" post_tag button button_translucent" data-position=1 title="tauri">TAURI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/tinyurl/' class=" post_tag button button_translucent" data-position=1 title="tinyurl">TINYURL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/tls/' class=" post_tag button button_translucent" data-position=1 title="tls">TLS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/tools/' class=" post_tag button button_translucent" data-position=2 title="tools">TOOLS<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/typescript/' class=" post_tag button button_translucent" data-position=4 title="typescript">TYPESCRIPT<span class="button_tally">4</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/ubuntu/' class=" post_tag button button_translucent" data-position=2 title="ubuntu">UBUNTU<span class="button_tally">2</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/ui/' class=" post_tag button button_translucent" data-position=1 title="ui">UI<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/unity/' class=" post_tag button button_translucent" data-position=5 title="unity">UNITY<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/unreal/' class=" post_tag button button_translucent" data-position=1 title="unreal">UNREAL<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/video/' class=" post_tag button button_translucent" data-position=1 title="video">VIDEO<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/virtualbox/' class=" post_tag button button_translucent" data-position=1 title="virtualbox">VIRTUALBOX<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/vscode/' class=" post_tag button button_translucent" data-position=1 title="vscode">VSCODE<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/vue/' class=" post_tag button button_translucent" data-position=7 title="vue">VUE<span class="button_tally">7</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/wails/' class=" post_tag button button_translucent" data-position=1 title="wails">WAILS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/web/' class=" post_tag button button_translucent" data-position=5 title="web">WEB<span class="button_tally">5</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/webapp/' class=" post_tag button button_translucent" data-position=1 title="webapp">WEBAPP<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/websocket/' class=" post_tag button button_translucent" data-position=1 title="websocket">WEBSOCKET<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/webview/' class=" post_tag button button_translucent" data-position=1 title="webview">WEBVIEW<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/windows/' class=" post_tag button button_translucent" data-position=1 title="windows">WINDOWS<span class="button_tally">1</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/xcode/' class=" post_tag button button_translucent" data-position=15 title="xcode">XCODE<span class="button_tally">15</span>
            </a>
            
            
            <a href='https://William-Weng.github.io/tags/yaml/' class=" post_tag button button_translucent" data-position=1 title="yaml">YAML<span class="button_tally">1</span>
            </a>
            
            <div class="tags_sort"><span title="sort alphabetically">[A~Z]</span><span title="sort by count">[0~9]</span>
            </div>
            <span class="tags_hide"><svg class="icon">
            <use xlink:href="#closeme"></use>
          </svg></span>
          </div>
        </div>
      </nav>
    </div>
  </section>
</aside>

  
</div>
    </main><svg width="0" height="0" class="hidden">
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="facebook">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h151V331h-60v-90h60v-61c0-49.629 40.371-90 90-90h91v90h-91v61h91l-15 90h-76v181h121c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18.001 18.001" id="twitter">
    <path d="M15.891 4.013c.808-.496 1.343-1.173 1.605-2.034a8.68 8.68 0 0 1-2.351.861c-.703-.756-1.593-1.14-2.66-1.14-1.043 0-1.924.366-2.643 1.078a3.56 3.56 0 0 0-1.076 2.605c0 .309.039.585.117.819-3.076-.105-5.622-1.381-7.628-3.837-.34.601-.51 1.213-.51 1.846 0 1.301.549 2.332 1.645 3.089-.625-.053-1.176-.211-1.645-.47 0 .929.273 1.705.82 2.388a3.623 3.623 0 0 0 2.115 1.291c-.312.08-.641.118-.979.118-.312 0-.533-.026-.664-.083.23.757.664 1.371 1.291 1.841a3.652 3.652 0 0 0 2.152.743C4.148 14.173 2.625 14.69.902 14.69c-.422 0-.721-.006-.902-.038 1.697 1.102 3.586 1.649 5.676 1.649 2.139 0 4.029-.542 5.674-1.626 1.645-1.078 2.859-2.408 3.639-3.974a10.77 10.77 0 0 0 1.172-4.892v-.468a7.788 7.788 0 0 0 1.84-1.921 8.142 8.142 0 0 1-2.11.593z"
      ></path>
  </symbol>
  <symbol aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="mail">
    <path  d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="calendar">
    <path d="M452 40h-24V0h-40v40H124V0H84v40H60C26.916 40 0 66.916 0 100v352c0 33.084 26.916 60 60 60h392c33.084 0 60-26.916 60-60V100c0-33.084-26.916-60-60-60zm20 412c0 11.028-8.972 20-20 20H60c-11.028 0-20-8.972-20-20V188h432v264zm0-304H40v-48c0-11.028 8.972-20 20-20h24v40h40V80h264v40h40V80h24c11.028 0 20 8.972 20 20v48z"></path>
    <path d="M76 230h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 310h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zM76 390h40v40H76zm80 0h40v40h-40zm80 0h40v40h-40zm80 0h40v40h-40zm80-80h40v40h-40z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="github">
    <path d="M255.968 5.329C114.624 5.329 0 120.401 0 262.353c0 113.536 73.344 209.856 175.104 243.872 12.8 2.368 17.472-5.568 17.472-12.384 0-6.112-.224-22.272-.352-43.712-71.2 15.52-86.24-34.464-86.24-34.464-11.616-29.696-28.416-37.6-28.416-37.6-23.264-15.936 1.728-15.616 1.728-15.616 25.696 1.824 39.2 26.496 39.2 26.496 22.848 39.264 59.936 27.936 74.528 21.344 2.304-16.608 8.928-27.936 16.256-34.368-56.832-6.496-116.608-28.544-116.608-127.008 0-28.064 9.984-51.008 26.368-68.992-2.656-6.496-11.424-32.64 2.496-68 0 0 21.504-6.912 70.4 26.336 20.416-5.696 42.304-8.544 64.096-8.64 21.728.128 43.648 2.944 64.096 8.672 48.864-33.248 70.336-26.336 70.336-26.336 13.952 35.392 5.184 61.504 2.56 68 16.416 17.984 26.304 40.928 26.304 68.992 0 98.72-59.84 120.448-116.864 126.816 9.184 7.936 17.376 23.616 17.376 47.584 0 34.368-.32 62.08-.32 70.496 0 6.88 4.608 14.88 17.6 12.352C438.72 472.145 512 375.857 512 262.353 512 120.401 397.376 5.329 255.968 5.329z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 212 212" id="gitlab">
    <path d="M12.3 74.7h54L43.3 3c-1-3.6-6.4-3.6-7.6 0L12.3 74.8z" />
    <path d="M12.3 74.7L.5 111c-1 3.2 0 6.8 3 8.8l101.6 74-92.5-119z"/>
    <path d="M105 193.7l-38.6-119h-54l92.7 119z"/>
    <path d="M105 193.7l38.7-119H66.4l38.7 119z"/>
    <path d="M105 193.7l38.7-119H198l-93 119z"/>
    <path d="M198 74.7l11.6 36.2c1 3 0 6.6-3 8.6l-101.5 74 93-119z"/>
    <path d="M198 74.7h-54.3L167 3c1.2-3.6 6.4-3.6 7.6 0L198 74.8z"/>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="rss">
    <circle cx="3.429" cy="20.571" r="3.429"></circle>
    <path d="M11.429 24h4.57C15.999 15.179 8.821 8.001 0 8v4.572c6.302.001 11.429 5.126 11.429 11.428z"></path>
    <path d="M24 24C24 10.766 13.234 0 0 0v4.571c10.714 0 19.43 8.714 19.43 19.429z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="linkedin">
    <path d="M437 0H75C33.648 0 0 33.648 0 75v362c0 41.352 33.648 75 75 75h362c41.352 0 75-33.648 75-75V75c0-41.352-33.648-75-75-75zM181 406h-60V196h60zm0-240h-60v-60h60zm210 240h-60V286c0-16.54-13.46-30-30-30s-30 13.46-30 30v120h-60V196h60v11.309C286.719 202.422 296.93 196 316 196c40.691.043 75 36.547 75 79.688zm0 0"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 612 612" id="to-top">
    <path d="M604.501 440.509L325.398 134.956c-5.331-5.357-12.423-7.627-19.386-7.27-6.989-.357-14.056 1.913-19.387 7.27L7.499 440.509c-9.999 10.024-9.999 26.298 0 36.323s26.223 10.024 36.222 0l262.293-287.164L568.28 476.832c9.999 10.024 26.222 10.024 36.221 0 9.999-10.023 9.999-26.298 0-36.323z"></path>
  </symbol>
  <symbol viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" id="carly">
    <path d="M504.971 239.029L448 182.059V84c0-46.317-37.682-84-84-84h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c19.851 0 36 16.149 36 36v108c0 6.365 2.529 12.47 7.029 16.971L454.059 256l-47.029 47.029A24.002 24.002 0 0 0 400 320v108c0 19.851-16.149 36-36 36h-44c-13.255 0-24 10.745-24 24s10.745 24 24 24h44c46.318 0 84-37.683 84-84v-98.059l56.971-56.971c9.372-9.372 9.372-24.568 0-33.941zM112 192V84c0-19.851 16.149-36 36-36h44c13.255 0 24-10.745 24-24S205.255 0 192 0h-44c-46.318 0-84 37.683-84 84v98.059l-56.971 56.97c-9.373 9.373-9.373 24.568 0 33.941L64 329.941V428c0 46.317 37.682 84 84 84h44c13.255 0 24-10.745 24-24s-10.745-24-24-24h-44c-19.851 0-36-16.149-36-36V320c0-6.365-2.529-12.47-7.029-16.971L57.941 256l47.029-47.029A24.002 24.002 0 0 0 112 192z"></path>
  </symbol>
  <symbol viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" id="copy">
    <path d="M23 2.75A2.75 2.75 0 0 0 20.25 0H8.75A2.75 2.75 0 0 0 6 2.75v13.5A2.75 2.75 0 0 0 8.75 19h11.5A2.75 2.75 0 0 0 23 16.25zM18.25 14.5h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5zm0-3h-7.5a.75.75 0 0 1 0-1.5h7.5a.75.75 0 0 1 0 1.5z"></path>
    <path d="M8.75 20.5a4.255 4.255 0 0 1-4.25-4.25V2.75c0-.086.02-.166.025-.25H3.75A2.752 2.752 0 0 0 1 5.25v16A2.752 2.752 0 0 0 3.75 24h12a2.752 2.752 0 0 0 2.75-2.75v-.75z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.001 512.001" id="closeme">
    <path d="M284.286 256.002L506.143 34.144c7.811-7.811 7.811-20.475 0-28.285-7.811-7.81-20.475-7.811-28.285 0L256 227.717 34.143 5.859c-7.811-7.811-20.475-7.811-28.285 0-7.81 7.811-7.811 20.475 0 28.285l221.857 221.857L5.858 477.859c-7.811 7.811-7.811 20.475 0 28.285a19.938 19.938 0 0 0 14.143 5.857 19.94 19.94 0 0 0 14.143-5.857L256 284.287l221.857 221.857c3.905 3.905 9.024 5.857 14.143 5.857s10.237-1.952 14.143-5.857c7.811-7.811 7.811-20.475 0-28.285L284.286 256.002z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" id="open-menu">
    <path d="M492 236H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0-160H20C8.954 76 0 84.954 0 96s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20zm0 320H20c-11.046 0-20 8.954-20 20s8.954 20 20 20h472c11.046 0 20-8.954 20-20s-8.954-20-20-20z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="instagram">
    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id=youtube>
    <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="stackoverflow">
    <path d="M21 27v-8h3v11H0V19h3v8h18z"></path><path d="M17.1.2L15 1.8l7.9 10.6 2.1-1.6L17.1.2zm3.7 14.7L10.6 6.4l1.7-2 10.2 8.5-1.7 2zM7.2 12.3l12 5.6 1.1-2.4-12-5.6-1.1 2.4zm-1.8 6.8l13.56 1.96.17-2.38-13.26-2.55-.47 2.97zM19 25H5v-3h14v3z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="xing">
    <path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 71 55" id="discord">
    <path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.440769 45.4204 0.525289C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.525289C25.5141 0.443589 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.038 50.6034 51.2554 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978ZM23.7259 37.3253C20.2276 37.3253 17.3451 34.1136 17.3451 30.1693C17.3451 26.225 20.1717 23.0133 23.7259 23.0133C27.308 23.0133 30.1626 26.2532 30.1066 30.1693C30.1066 34.1136 27.28 37.3253 23.7259 37.3253ZM47.3178 37.3253C43.8196 37.3253 40.9371 34.1136 40.9371 30.1693C40.9371 26.225 43.7636 23.0133 47.3178 23.0133C50.9 23.0133 53.7545 26.2532 53.6986 30.1693C53.6986 34.1136 50.9 37.3253 47.3178 37.3253Z"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 18" id="mastodon">
    <path
    fill="#ffffff"
    d="m 15.054695,9.8859583 c -0.22611,1.1632697 -2.02517,2.4363497 -4.09138,2.6830797 -1.0774504,0.12856 -2.1382704,0.24673 -3.2694704,0.19484 -1.84996,-0.0848 -3.30971,-0.44157 -3.30971,-0.44157 0,0.1801 0.0111,0.35157 0.0333,0.51194 0.24051,1.82571 1.81034,1.93508 3.29737,1.98607 1.50088,0.0514 2.8373104,-0.37004 2.8373104,-0.37004 l 0.0617,1.35686 c 0,0 -1.0498104,0.56374 -2.9199404,0.66742 -1.03124,0.0567 -2.3117,-0.0259 -3.80308,-0.42069 -3.23454998,-0.85613 -3.79081998,-4.304 -3.87592998,-7.8024197 -0.026,-1.03871 -0.01,-2.01815 -0.01,-2.83732 0,-3.57732 2.34385998,-4.62587996 2.34385998,-4.62587996 1.18184,-0.54277 3.20976,-0.77101 5.318,-0.7882499985409 h 0.0518 C 9.8267646,0.01719834 11.856025,0.24547834 13.037775,0.78824834 c 0,0 2.34377,1.04855996 2.34377,4.62587996 0,0 0.0294,2.63937 -0.32687,4.47183"/>
 <path
    fill="#000000"
    d="m 12.616925,5.6916583 v 4.3315297 h -1.71607 V 5.8189683 c 0,-0.88624 -0.37289,-1.33607 -1.1187604,-1.33607 -0.82467,0 -1.23799,0.53361 -1.23799,1.58875 v 2.30122 h -1.70594 v -2.30122 c 0,-1.05514 -0.4134,-1.58875 -1.23808,-1.58875 -0.74587,0 -1.11876,0.44983 -1.11876,1.33607 v 4.2042197 h -1.71607 V 5.6916583 c 0,-0.88527 0.22541,-1.58876 0.67817,-2.10922 0.46689,-0.52047 1.07833,-0.78727 1.83735,-0.78727 0.87816,0 1.54317,0.33752 1.98288,1.01267 l 0.42744,0.71655 0.42753,-0.71655 c 0.43961,-0.67515 1.10463,-1.01267 1.9828704,-1.01267 0.75893,0 1.37037,0.2668 1.83735,0.78727 0.45268,0.52046 0.67808,1.22395 0.67808,2.10922"/>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 530" id="bluesky" >
    <path d="m135.72 44.03c66.496 49.921 138.02 151.14 164.28 205.46 26.262-54.316 97.782-155.54 164.28-205.46 47.98-36.021 125.72-63.892 125.72 24.795 0 17.712-10.155 148.79-16.111 170.07-20.703 73.984-96.144 92.854-163.25 81.433 117.3 19.964 147.14 86.092 82.697 152.22-122.39 125.59-175.91-31.511-189.63-71.766-2.514-7.3797-3.6904-10.832-3.7077-7.8964-0.0174-2.9357-1.1937 0.51669-3.7077 7.8964-13.714 40.255-67.233 197.36-189.63 71.766-64.444-66.128-34.605-132.26 82.697-152.22-67.108 11.421-142.55-7.4491-163.25-81.433-5.9562-21.282-16.111-152.36-16.111-170.07 0-88.687 77.742-60.816 125.72-24.795z"/>
  </symbol>
</svg>

<footer class="footer">
  <div class="footer_inner wrap pale">
    <img src='https://William-Weng.github.io/icons/apple-touch-icon.png' class="icon icon_2 transparent" alt="William-Weng">
    <p>Copyright&nbsp;<span class="year"></span>&nbsp;WILLIAM-WENG. All Rights Reserved</p><a class="to_top" href="#documentTop">
  <svg class="icon">
  <title>to-top</title>
  <use xlink:href="#to-top"></use>
</svg>

</a>

  </div>
</footer>

<script type="text/javascript" src="https://William-Weng.github.io/en/js/bundle.ef18b7cbccbaaff8de21870709eafc196f6f5ffe0a978d7cc1fc489d084755617a79d19dff9f284e00b02ee517b64e64dc02d7ea310d40d485a957333cef7099.js" integrity="sha512-7xi3y8y6r/jeIYcHCer8GW9vX/4Kl418wfxInQhHVWF6edGd/58oTgCwLuUXtk5k3ALX6jENQNSFqVczPO9wmQ==" crossorigin="anonymous"></script>
  </body>
</html>
